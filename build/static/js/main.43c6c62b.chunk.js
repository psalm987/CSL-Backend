(this.webpackJsonpadmin=this.webpackJsonpadmin||[]).push([[0],{324:function(e,t,a){},325:function(e,t,a){},363:function(e,t){},395:function(e,t){},399:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a(0),c=a.n(r),i=a(17),o=a.n(i),s=(a(324),a(325),a(40)),l=a(281),u=a(37),d=a(33),j=a(280),b=a.n(j),h=a(7),O=a(467),f=a(101),p=a(66),x=a(11),m=a(292),v=function(e){return Object(n.jsx)("div",{style:{marginTop:8,marginBottom:8,width:"100%"},children:Object(n.jsx)(m.a,Object(x.a)({variant:"outlined",fullWidth:!0},e))})},g=function(){return Object(n.jsx)(O.a,{flexGrow:1,style:{backgroundColor:"black",backgroundImage:"url(https://picsum.photos/1000/1000?grayscale)",backgroundRepeat:"no-repeat",backgroundSize:"cover"},height:1})},y=a(136),w=a.n(y),C=a(95),k=a.n(C),S=function(e){return!e||e.length<=0?"Email cannot be empty.":/\S+@\S+\.\S+/.test(e)?"":"Ooops! We need a valid email address."},N=function(e){return!e||e.length<=0?"Password cannot be empty.":""},E=function(e){return!e||e.length<=0?"Phone cannot be empty.":/^0\d{10}$/.test(e.toString().replace(/\s/g,""))||/^\+234\d{10}$/.test(e.toString().replace(/\s/g,""))?"":"Invalid phone format."},D=function(e){if(!e)return"Date of birth cannot be empty.";var t=new Date-new Date(e),a=new Date(t).getFullYear()-1970;return a<6||a>120?"Invalid date of birth":""},I=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],A=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],R=function(e){return[0,1,2,3,4,5,6].map((function(t){var a=e.filter((function(e){return e._id.day===t})),n=a.find((function(e){return"Cancelled"===e._id.status}))||{revenue:0,total:0},r=a.find((function(e){return"Delivered"===e._id.status}))||{revenue:0,total:0};return[{date:I[t],sales:r.total,cancelled:n.total},{date:I[t],sales:r.revenue,cancelled:n.revenue}]})).filter((function(e){return 0!==e[0].sales||0!==e[0].cancelled||0!==e[1].sales||0!==e[1].cancelled}))},T=function(e){return[0,1,2,3,4,5,6,7,8,9,10,11,12].map((function(t){var a=e.filter((function(e){return e._id.month===t})),n=a.find((function(e){return"Cancelled"===e._id.status}))||{revenue:0,total:0},r=a.find((function(e){return"Delivered"===e._id.status}))||{revenue:0,total:0};return[{date:A[t-1],sales:r.total,cancelled:n.total},{date:A[t-1],sales:r.revenue,cancelled:n.revenue}]})).filter((function(e){return 0!==e[0].sales||0!==e[0].cancelled||0!==e[1].sales||0!==e[1].cancelled}))},P=Object(r.createContext)(),_=Object(r.createContext)(),L=a(451),W=a(85),F=function(e){var t=c.a.useContext(P).setAlert,a=c.a.useContext(_),r=a.loading,i=a.login,o=a.isAuthenticated,s=c.a.useState(""),l=Object(h.a)(s,2),d=l[0],j=l[1],b=c.a.useState(""),x=Object(h.a)(b,2),m=x[0],y=x[1],C=c.a.useState(!1),E=Object(h.a)(C,2),D=E[0],I=E[1];return c.a.useEffect((function(){o&&e.history.push("/dashboard/analytics")}),[o]),Object(n.jsxs)(O.a,{width:1,display:"flex",flexDirection:"row",height:1,children:[Object(n.jsxs)(O.a,{width:800,alignItems:"center",justifyContent:"center",height:1,display:"flex",flexDirection:"column",children:[Object(n.jsx)(O.a,{height:.25}),Object(n.jsxs)(O.a,{p:5,m:0,width:.8,children:[Object(n.jsx)(O.a,{display:"flex",justifyContent:"center",children:Object(n.jsx)(p.a,{variant:"h4",color:"primary",alignText:"center",gutterBottom:!0,children:"Sign In"})}),Object(n.jsx)(v,{id:"outlined-basic",value:d,onChange:function(e){return j(e.target.value)},label:"Email",required:!0}),Object(n.jsx)(v,{id:"outlined-basic",value:m,onChange:function(e){return y(e.target.value)},label:"Password",type:D?"text":"password",required:!0,InputProps:{endAdornment:Object(n.jsx)(L.a,{position:"end",children:Object(n.jsx)(W.a,{onClick:function(){return I(!D)},children:D?Object(n.jsx)(w.a,{}):Object(n.jsx)(k.a,{})})})}}),Object(n.jsx)(f.a,{variant:"contained",color:"primary",size:"large",fullWidth:!0,onClick:function(){var e=S(d)||N(m);e?t(e,"error"):i({email:d,password:m})},disabled:r,children:r?"Loading...":"Login"}),Object(n.jsx)(O.a,{display:"flex",justifyContent:"flex-end",my:1,children:Object(n.jsx)(p.a,{variant:"body2",color:"primary",align:"right",style:{margin:8,textDecoration:"none"},component:u.b,to:"/forgot",children:"Forgot Password"})})]}),Object(n.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"flex-end",height:.25,children:Object(n.jsx)(p.a,{variant:"body2",color:"textPrimary",align:"right",style:{margin:8,textDecoration:"none"},component:u.b,to:"/register",children:"Create an Account"})})]}),Object(n.jsx)(g,{})]})},M=a(14),B=a.n(M),U=a(20),V=a(468),G=function(e){var t=c.a.useContext(P).setAlert,a=c.a.useContext(_),r=a.register,i=a.error,o=a.isAuthenticated,s=c.a.useState(null),l=Object(h.a)(s,2),d=l[0],j=l[1],b=c.a.useState(""),x=Object(h.a)(b,2),m=x[0],y=x[1],C=c.a.useState(""),I=Object(h.a)(C,2),A=I[0],R=I[1],T=c.a.useState(""),F=Object(h.a)(T,2),M=F[0],G=F[1],z=c.a.useState(""),H=Object(h.a)(z,2),Q=H[0],Z=H[1],q=c.a.useState(""),K=Object(h.a)(q,2),J=K[0],$=K[1],Y=c.a.useState(!1),X=Object(h.a)(Y,2),ee=X[0],te=X[1];c.a.useEffect((function(){o&&e.history.push("/login")}),[o,e.history]);var ae=function(){var e=Object(U.a)(B.a.mark((function e(){var a,n,c,i,o,s;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=""===m?"Please fill in your full name":"",n=S(A),c=N(M),i=E(Q),o=""===J?"Please fill in the registration secret":"",s=D(d),a||n||c||i||o||s?t([a,n,i,c,o,s].find((function(e){return e})),"error"):r({name:m,email:A,password:M,phone:Q,birthday:d,secret:J});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c.a.useEffect((function(){i&&t(i,"error")}),[i,t]),Object(n.jsxs)(O.a,{width:1,display:"flex",flexDirection:"row",height:1,children:[Object(n.jsxs)(O.a,{width:800,alignItems:"center",justifyContent:"center",height:1,display:"flex",flexDirection:"column",children:[Object(n.jsx)(O.a,{height:.25}),Object(n.jsxs)(O.a,{p:5,m:0,width:.8,children:[Object(n.jsx)(O.a,{display:"flex",justifyContent:"center",children:Object(n.jsx)(p.a,{variant:"h4",color:"primary",alignText:"center",gutterBottom:!0,children:"Create an Account"})}),Object(n.jsx)(v,{id:"outlined-basic",label:"Name",value:m,onChange:function(e){return y(e.target.value)}}),Object(n.jsx)(V.a,{variant:"inline",inputVariant:"outlined",label:"Birthday",value:d,onChange:j,fullWidth:!0,views:["month","date","year"]}),Object(n.jsx)(v,{id:"outlined-basic",label:"Email",value:A,onChange:function(e){return R(e.target.value)}}),Object(n.jsxs)(O.a,{display:"flex",flexDirection:"row",children:[Object(n.jsx)(v,{id:"outlined-basic",label:"Phone",value:Q,onChange:function(e){return Z(e.target.value)}}),Object(n.jsx)(v,{id:"outlined-basic",label:"Password",value:M,onChange:function(e){return G(e.target.value)},type:ee?"text":"password",InputProps:{endAdornment:Object(n.jsx)(L.a,{position:"end",children:Object(n.jsx)(W.a,{onClick:function(){return te(!ee)},children:ee?Object(n.jsx)(w.a,{}):Object(n.jsx)(k.a,{})})})}})]}),Object(n.jsx)(v,{id:"outlined-basic",label:"Secret",value:J,onChange:function(e){return $(e.target.value)}}),Object(n.jsx)(f.a,{variant:"contained",color:"primary",size:"large",onClick:ae,fullWidth:!0,children:"Register"})]}),Object(n.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"flex-end",height:.15,children:Object(n.jsx)(p.a,{variant:"body2",color:"textPrimary",align:"right",style:{margin:8,textDecoration:"none"},component:u.b,to:"/login",children:"Back to Login"})})]}),Object(n.jsx)(g,{})]})},z=function(){return Object(n.jsxs)(O.a,{width:1,display:"flex",flexDirection:"row",height:1,children:[Object(n.jsxs)(O.a,{width:800,alignItems:"center",justifyContent:"center",height:1,display:"flex",flexDirection:"column",children:[Object(n.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"center",height:.25}),Object(n.jsxs)(O.a,{p:5,m:0,width:.8,children:[Object(n.jsx)(O.a,{display:"flex",justifyContent:"center",children:Object(n.jsx)(p.a,{variant:"h4",color:"primary",alignText:"center",gutterBottom:!0,children:"Forgot Password"})}),Object(n.jsx)(v,{id:"outlined-basic",label:"Email"}),Object(n.jsx)(f.a,{variant:"contained",color:"primary",size:"large",fullWidth:!0,children:"Send reset to email"})]}),Object(n.jsx)(O.a,{display:"flex",justifyContent:"center",alignItems:"flex-end",height:.25,children:Object(n.jsx)(p.a,{variant:"body2",color:"textPrimary",align:"right",style:{margin:8,textDecoration:"none"},component:u.b,to:"/login",children:"Back to Login"})})]}),Object(n.jsx)(g,{})]})},H=a(4),Q=a(456),Z=a(84),q=a(77),K=a(25),J=a(114),$=Object(J.a)((function(e){return{avatar:{height:e.spacing(10),width:e.spacing(10)},card:{width:"100%"},primary:{backgroundColor:e.palette.primary.main},primaryText:{color:e.palette.primary.contrastText}}})),Y=["#c70039","#111d5e","#f37121","#ffbd69","#334E7E"],X=function(e){var t=e.lineValues,a=e.barValues,r=e.argument,c=e.data,i=$();return Array.isArray(c)&&c.length>0?Object(n.jsx)(Z.a,{className:i.card,children:Object(n.jsx)(O.a,{p:2,children:Object(n.jsxs)(q.c,{data:c,height:200,children:[Object(n.jsx)(K.i,{scheme:Y}),Object(n.jsx)(q.a,{})," ",Object(n.jsx)(q.g,{}),Object(n.jsx)(K.f,{})," ",Object(n.jsx)(q.f,{}),Object(n.jsx)(K.a,{}),a&&a.map((function(e,t){return Object(n.jsx)(q.b,{valueField:e,argumentField:r},t)})),t&&t.map((function(e,t){return Object(n.jsx)(q.d,{valueField:e,argumentField:r},t)})),t&&t.map((function(e,t){return Object(n.jsx)(q.e,{valueField:e,argumentField:r},t)}))]})})}):Object(n.jsx)(Z.a,{className:i.card,children:Object(n.jsx)(O.a,{p:2,height:200,display:"flex",alignItems:"center",justifyContent:"center",children:Object(n.jsx)(p.a,{variant:"subtitle1",color:"initial",children:"No data available"})})})},ee=a(19),te=a.n(ee),ae=Object(J.a)((function(e){return{card:{width:"100%"},primary:{backgroundColor:e.palette.primary.main},primaryText:{color:e.palette.primary.contrastText}}})),ne=function(){var e=ae(),t=c.a.useContext(_).loadUser,a=c.a.useState({deliveries:0,cancelled:0}),r=Object(h.a)(a,2),i=r[0],o=r[1],s=c.a.useState({deliveries:0,cancelled:0}),l=Object(h.a)(s,2),u=l[0],d=l[1],j=c.a.useState([]),b=Object(h.a)(j,2),f=b[0],x=b[1],m=c.a.useState([]),v=Object(h.a)(m,2),g=v[0],y=v[1],w=c.a.useState([]),C=Object(h.a)(w,2),k=C[0],S=C[1],N=c.a.useState([]),E=Object(h.a)(N,2),D=E[0],I=E[1],A=c.a.useState([]),P=Object(h.a)(A,2),L=P[0],W=P[1],F=c.a.useState([]),M=Object(h.a)(F,2),V=M[0],G=M[1];return c.a.useEffect((function(){Object(U.a)(B.a.mark((function e(){var a,n,r,c;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(),e.next=4,te.a.get("/api/admin/performance");case 4:a=e.sent,n=a.data,r=n.day.find((function(e){return"Deliveries"===e._id}))||{total:0,revenue:0},c=n.day.find((function(e){return"Cancelled"===e._id}))||{total:0,revenue:0},o({deliveries:r.total,cancelled:c.total}),d({deliveries:r.revenue,cancelled:c.revenue}),x(R(n.weekly)),y(T(n.monthly)),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))()}),[]),c.a.useEffect((function(){W(f.map((function(e){return e[0]}))),G(f.map((function(e){return e[1]}))),I(g.map((function(e){return e[1]}))),S(g.map((function(e){return e[0]})))}),[f,g]),Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsxs)(O.a,{display:"flex",flexDirection:"row",mb:3,children:[Object(n.jsx)(p.a,{variant:"h5",color:"secondary",gutterBottom:!0,children:"Welcome Back,"}),Object(n.jsx)(O.a,{width:10}),Object(n.jsx)(p.a,{variant:"h5",color:"initial",gutterBottom:!0,children:"Admin"})]}),Object(n.jsxs)(Q.a,{container:!0,spacing:5,children:[Object(n.jsx)(Q.a,{item:!0,xs:4,children:Object(n.jsx)(p.a,{variant:"subtitle1",color:"inherit",children:"Today"})}),Object(n.jsx)(Q.a,{item:!0,xs:4,children:Object(n.jsx)(p.a,{variant:"subtitle1",color:"inherit",children:"This week"})}),Object(n.jsx)(Q.a,{item:!0,xs:4,children:Object(n.jsx)(p.a,{variant:"subtitle1",color:"inherit",children:"Monthly"})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:4,children:Object(n.jsx)(Z.a,{className:Object(H.a)([e.card,e.primary]),children:Object(n.jsxs)(O.a,{p:2,children:[Object(n.jsx)(p.a,{variant:"h6",color:"textPrimary",className:e.primaryText,children:"Sales"}),Object(n.jsx)(O.a,{height:30}),Object(n.jsx)(p.a,{variant:"body1",color:"textSecondary",className:e.primaryText,children:"".concat(i.deliveries," Deliveries")}),Object(n.jsx)(p.a,{variant:"body1",color:"textSecondary",className:e.primaryText,children:"".concat(i.cancelled," Cancelled")})]})})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:4,children:Object(n.jsx)(X,{data:L,argument:"date",lineValues:["cancelled","sales"]})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:4,children:Object(n.jsx)(X,{data:k,argument:"date",barValues:["cancelled","sales"]})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:4,children:Object(n.jsx)(Z.a,{className:e.card,children:Object(n.jsxs)(O.a,{p:2,children:[Object(n.jsx)(p.a,{variant:"h6",color:"secondary",children:"Revenue"}),Object(n.jsx)(O.a,{height:30}),Object(n.jsx)(p.a,{variant:"body1",color:"inherit",children:"".concat(u.deliveries," Deliveries")}),Object(n.jsx)(p.a,{variant:"body1",color:"inherit",children:"".concat(u.cancelled," Cancelled")})]})})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:4,children:Object(n.jsx)(X,{data:V,argument:"date",lineValues:["cancelled","sales"]})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:4,children:Object(n.jsx)(X,{data:D,argument:"date",barValues:["cancelled","sales"]})})]})]})},re=a(12),ce=a(16),ie=a(34),oe=a(459),se=a(458),le=a(455),ue=a(286),de=a(457),je=a(460),be=a(231),he=a.n(be),Oe=a(138),fe=a.n(Oe),pe=a(100),xe=a.n(pe),me=a(289),ve=a(405),ge=a(403),ye=a(293),we=a(106),Ce=a.n(we),ke=a(225),Se=a.n(ke),Ne=a(226),Ee=a.n(Ne),De=a(227),Ie=a.n(De),Ae=a(228),Re=a.n(Ae),Te=a(229),Pe=a.n(Te),_e=a(232),Le=a.n(_e),We=a(137),Fe=a.n(We),Me=a(230),Be=a.n(Me),Ue=240,Ve=[{title:"Analytics",icon:Object(n.jsx)(Se.a,{}),to:"/dashboard/analytics"},{title:"Deliveries",icon:Object(n.jsx)(Ee.a,{}),to:"/dashboard/deliveries"},{title:"Drivers",icon:Object(n.jsx)(Ie.a,{}),to:"/dashboard/drivers"},{title:"Users",icon:Object(n.jsx)(Fe.a,{}),to:"/dashboard/users"},{title:"Coupons",icon:Object(n.jsx)(Re.a,{}),to:"/dashboard/coupons"},{title:"Pricing",icon:Object(n.jsx)(Pe.a,{}),to:"/dashboard/pricing"},{title:"Adverts",icon:Object(n.jsx)(Be.a,{}),to:"/dashboard/ads"}],Ge=Object(J.a)((function(e){return{root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:Ue,width:"calc(100% - ".concat(Ue,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},hide:{display:"none"},drawer:{width:Ue,flexShrink:0,whiteSpace:"nowrap"},drawerOpen:{width:Ue,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:Object(re.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:e.spacing(7)+1},e.breakpoints.up("sm"),{width:e.spacing(9)+1}),toolbar:Object(x.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1)},e.mixins.toolbar),title:Object(re.a)({flexGrow:1,display:"none"},e.breakpoints.up("sm"),{display:"block"}),search:Object(re.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(ce.c)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(ce.c)(e.palette.common.white,.25)},marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(1),width:"auto"}),searchIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:Object(re.a)({padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)"),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("sm"),{width:"40ch","&:focus":{width:"50ch"}}),content:{flexGrow:1,padding:e.spacing(3)}}}));function ze(e){var t,a,i=Ge(),o=Object(ie.a)(),s=c.a.useState(!1),l=Object(h.a)(s,2),d=l[0],j=l[1],b=Object(r.useContext)(_),f=(b.user,b.logout);return Object(n.jsxs)("div",{className:i.root,children:[Object(n.jsx)(de.a,{}),Object(n.jsx)(se.a,{position:"fixed",className:Object(H.a)(i.appBar,Object(re.a)({},i.appBarShift,d)),children:Object(n.jsxs)(le.a,{children:[Object(n.jsx)(W.a,{color:"inherit","aria-label":"open drawer",onClick:function(){j(!0)},edge:"start",className:Object(H.a)(i.menuButton,Object(re.a)({},i.hide,d)),children:Object(n.jsx)(he.a,{})}),Object(n.jsx)(O.a,{display:"flex",flexGrow:1,children:Object(n.jsxs)("div",{className:i.search,children:[Object(n.jsx)("div",{className:i.searchIcon,children:Object(n.jsx)(Ce.a,{})}),Object(n.jsx)(ye.a,{placeholder:"Search for deliveries, drivers, clients and coupons...",classes:{root:i.inputRoot,input:i.inputInput},inputProps:{"aria-label":"search"}})]})}),Object(n.jsxs)(O.a,{color:"textSecondary",display:"flex",flexDirection:"row",alignItems:"center",children:[Object(n.jsx)(O.a,{color:"white",component:"span",children:Object(n.jsx)(p.a,{variant:"h6",color:"inherit",children:"Logout"})}),Object(n.jsx)(W.a,{color:"inherit",onClick:f,children:Object(n.jsx)(Le.a,{})})]})]})}),Object(n.jsxs)(oe.a,{variant:"permanent",className:Object(H.a)(i.drawer,(t={},Object(re.a)(t,i.drawerOpen,d),Object(re.a)(t,i.drawerClose,!d),t)),classes:{paper:Object(H.a)((a={},Object(re.a)(a,i.drawerOpen,d),Object(re.a)(a,i.drawerClose,!d),a))},children:[Object(n.jsx)("div",{className:i.toolbar,children:Object(n.jsx)(W.a,{onClick:function(){j(!1)},children:"rtl"===o.direction?Object(n.jsx)(xe.a,{}):Object(n.jsx)(fe.a,{})})}),Object(n.jsx)(je.a,{}),Object(n.jsx)(ue.a,{children:Ve.map((function(e,t){return Object(n.jsxs)(me.a,{button:!0,component:u.b,to:e.to,children:[Object(n.jsx)(ve.a,{children:e.icon}),Object(n.jsx)(ge.a,{primary:e.title})]},t)}))})]}),Object(n.jsxs)("main",{className:i.content,children:[Object(n.jsx)("div",{className:i.toolbar}),e.children]})]})}var He=a(10),Qe=a(469),Ze=a(461),qe=Object(J.a)((function(e){return{root:{flexGrow:1},padding:{padding:e.spacing(3)}}})),Ke=Object(He.a)((function(e){return{root:{borderBottom:"1px solid #e8e8e8"},indicator:{backgroundColor:e.palette.action.selected}}}))(Qe.a),Je=Object(He.a)((function(e){return{root:{textTransform:"none",minWidth:72,fontWeight:e.typography.fontWeightRegular,marginRight:e.spacing(4),fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(","),"&:hover":{color:e.palette.action.hover,opacity:1},"&$selected":{color:e.palette.action.selected,fontWeight:e.typography.fontWeightMedium},"&:focus":{color:e.palette.action.focus}},selected:{}}}))((function(e){return Object(n.jsx)(Ze.a,Object(x.a)({disableRipple:!0},e))})),$e=function(e){var t=e.aria,a=e.tabs,r=e.onChange,i=qe(),o=c.a.useState(0),s=Object(h.a)(o,2),l=s[0],u=s[1];c.a.useEffect((function(){r(l)}),[l,r]);return Object(n.jsx)("div",{className:i.root,children:Object(n.jsxs)("div",{className:i.demo1,children:[Object(n.jsx)(Ke,{value:l,onChange:function(e,t){u(t)},"aria-label":t,children:a.map((function(e,t){return Object(n.jsx)(Je,{label:e},t)}))}),Object(n.jsx)(p.a,{className:i.padding})]})})},Ye=a(55),Xe=a(15),et=function(e){var t=e.rows,a=e.columns,r=e.formatters,i=e.onClick,o=e.getRowId,s=e.columnExtensions,l=e.loading,u=e.footer,d=c.a.useState(),j=Object(h.a)(d,2),b=j[0],O=j[1];return c.a.useEffect((function(){b&&i&&i(b)}),[b,i]),Object(n.jsxs)(Z.a,{children:[Object(n.jsxs)(Ye.a,{rows:t,columns:a,getRowId:o,children:[Object(n.jsx)(Ye.g,{columnExtensions:s}),Object(n.jsx)(Ye.d,{}),Object(n.jsx)(Xe.k,{selection:b,onSelectionChange:function(e){return O([e.length&&e[e.length-1]])}}),l&&Object(n.jsx)(Xe.F,{loading:!0,getRows:function(){return t&&t.length||100}}),Object(n.jsx)(Ye.f,{selectByRowClick:!0,highlightRow:!0,showSelectionColumn:!1}),r]}),u]})},tt=Object(r.createContext)(),at=a(452),nt=a(463),rt=a(453),ct=a(180),it=a(86),ot=a(454),st=a(23),lt=a(470),ut=a(237),dt=a.n(ut),jt=a(236),bt=a.n(jt),ht=a(141),Ot=a.n(ht);a(359);var ft,pt={current:null},xt=Object(J.a)((function(e){return{icon:{color:e.palette.text.secondary,marginRight:e.spacing(2)}}}));function mt(e){var t=e.onChange,a=e.label,r=xt(),i=c.a.useState(null),o=Object(h.a)(i,2),s=o[0],l=o[1],u=c.a.useState(""),d=Object(h.a)(u,2),j=d[0],b=d[1],O=c.a.useState([]),f=Object(h.a)(O,2),v=f[0],g=f[1],y=c.a.useRef(!1);"undefined"===typeof window||y.current||(document.querySelector("#google-maps")||function(e,t,a){if(t){var n=document.createElement("script");n.setAttribute("async",""),n.setAttribute("id",a),n.src=e,t.appendChild(n)}}("https://maps.googleapis.com/maps/api/js?key=AIzaSyAVa67y3wWEBxeAR5Q0p4PZtVknjarOlhQ&libraries=places",document.querySelector("head"),"google-maps"),y.current=!0);var w=c.a.useMemo((function(){return Ot()((function(e,t){pt.current.getPlacePredictions(e,t)}),200)}),[]);function C(e){l(e),e?ft.geocode({placeId:e.place_id},(function(a,n){if("OK"===n){var r=a[0].geometry.location,c={latitude:r.lat(),longitude:r.lng(),address:e.description};t&&t(c)}else console.log("Error...",n)})):t(null)}return c.a.useEffect((function(){var e=!0;if(pt.current&&pt.geocoder||!window.google||(pt.current=new window.google.maps.places.AutocompleteService,ft=new window.google.maps.Geocoder),pt.current){if(""!==j){var t=new window.google.maps.LatLng(4.8156,7.0498);return w({input:j,location:t,radius:24},(function(t){if(e){var a=[];s&&(a=[s]),t&&(a=[].concat(Object(st.a)(a),Object(st.a)(t))),g(a)}})),function(){e=!1}}g(s?[s]:[])}}),[s,j,w]),Object(n.jsx)(lt.a,{getOptionLabel:function(e){return"string"===typeof e?e:e.description},filterOptions:function(e){return e},options:v,autoComplete:!0,includeInputInList:!0,filterSelectedOptions:!0,value:s,noOptionsText:"Location not available",onChange:function(){var e=Object(U.a)(B.a.mark((function e(t,a){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g(a?[a].concat(Object(st.a)(v)):v),C(a);case 2:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),onInputChange:function(e,t){b(t)},renderInput:function(e){return Object(n.jsx)(m.a,Object(x.a)(Object(x.a)({},e),{},{label:a||"Add a location",variant:"outlined",fullWidth:!0}))},renderOption:function(e){var t=e.structured_formatting.main_text_matched_substrings,a=bt()(e.structured_formatting.main_text,t.map((function(e){return[e.offset,e.offset+e.length]})));return Object(n.jsxs)(Q.a,{container:!0,alignItems:"center",children:[Object(n.jsx)(Q.a,{item:!0,children:Object(n.jsx)(dt.a,{className:r.icon})}),Object(n.jsxs)(Q.a,{item:!0,xs:!0,children:[a.map((function(e,t){return Object(n.jsx)("span",{style:{fontWeight:e.highlight?700:400},children:e.text},t)})),Object(n.jsx)(p.a,{variant:"body2",color:"textSecondary",children:e.structured_formatting.secondary_text})]})]})}})}var vt=Object(J.a)((function(e){return{icon:{color:e.palette.text.secondary,marginRight:e.spacing(2)}}}));function gt(e){var t=e.onChange,a=e.label,r=e.role,i=vt(),o=c.a.useState(null),s=Object(h.a)(o,2),l=s[0],u=s[1],d=c.a.useState(""),j=Object(h.a)(d,2),b=j[0],O=j[1],f=c.a.useState([]),v=Object(h.a)(f,2),g=v[0],y=v[1],w=c.a.useState(!1),C=Object(h.a)(w,2),k=C[0],S=C[1];c.a.useEffect((function(){t&&t(l)}),[l,t]);var N=c.a.useMemo((function(){return Ot()((function(e,t){S(!0),te.a.get("/api/users/search/".concat(e.role,"?q=").concat(e.inputValue)).then((function(e){t&&t(e.data),S(!1)})).catch((function(e){console.error(e),S(!1)}))}),200)}),[]);return c.a.useEffect((function(){var e=!0;if(""!==b)return N({role:r||"client",inputValue:b},(function(t){if(e){var a=[];l&&(a=[l]),t&&(a=[].concat(Object(st.a)(a),Object(st.a)(t))),y(a)}})),function(){e=!1};y(l?[l]:[])}),[l,b,N,r]),Object(n.jsx)(lt.a,{id:"user-search",getOptionLabel:function(e){return"string"===typeof e?e:e.name},filterOptions:function(e){return e},options:g,autoComplete:!0,includeInputInList:!0,filterSelectedOptions:!0,noOptionsText:k?"Searching...":"User not available",value:l,onChange:function(e,a){y(a?[a].concat(Object(st.a)(g)):g),u(a),t(a)},onInputChange:function(e,t){O(t)},renderInput:function(e){return Object(n.jsx)(m.a,Object(x.a)(Object(x.a)({},e),{},{label:a||"Search User",variant:"outlined",fullWidth:!0}))},renderOption:function(e){return Object(n.jsxs)(Q.a,{container:!0,alignItems:"center",children:[Object(n.jsx)(Q.a,{item:!0,children:Object(n.jsx)(Fe.a,{className:i.icon})}),Object(n.jsxs)(Q.a,{item:!0,xs:!0,children:[Object(n.jsx)("span",{style:{fontWeight:700},children:e.name}),Object(n.jsx)(p.a,{variant:"body2",color:"textSecondary",children:"".concat(e.email," - ").concat(e.phone," ")})]})]})}})}for(var yt=Object(r.createContext)(),wt=(a(361),a(364),function(e){try{return new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).formatToParts(e).map((function(e){var t=e.type,a=e.value;switch(t){case"currency":return"\u20a6".concat(a," ");default:return a}})).reduce((function(e,t){return e+t})).replace("NGN ","").replace("\u20a6\u20a6","\u20a6")}catch(t){return"\u20a6".concat(e," ")}}),Ct=[],kt=0;kt<100;kt++)Ct.push({id:kt,dateCreated:(new Date).toISOString(),client:"Samuel Seibidor",pickUp:"10, Wogu Street D/Line, Port Harcourt",dropOff:"Creekside Logistics, Port Harcourt",distance:5,mode:"Motorcycle"});var St=[{name:"dateCreated",title:"Date Created"},{name:"client",title:"Client"},{name:"pickUp",title:"Pick-up"},{name:"dropOff",title:"Drop-off"},{name:"distance",title:"Distance (km)"},{name:"mode",title:"Mode"}],Nt=[{columnName:"distance",width:120,align:"center"}],Et=function(e){var t=e.value;return new Date(t).toLocaleDateString()},Dt=function(e){return Object(n.jsx)(Xe.b,Object(x.a)({formatterComponent:Et},e))},It=function(e){var t=c.a.useState(!1),a=Object(h.a)(t,2),r=a[0],i=a[1],o=c.a.useContext(yt).modes,s=c.a.useContext(P).setAlert,l=c.a.useState(null),u=Object(h.a)(l,2),d=u[0],j=u[1],b=c.a.useState(null),x=Object(h.a)(b,2),v=x[0],g=x[1],y=c.a.useState(""),w=Object(h.a)(y,2),C=w[0],k=w[1],S=c.a.useState(""),N=Object(h.a)(S,2),E=N[0],D=N[1],I=c.a.useState(""),A=Object(h.a)(I,2),R=A[0],T=A[1],_=c.a.useState(o[0]||""),L=Object(h.a)(_,2),W=L[0],F=L[1],M=c.a.useState(null),V=Object(h.a)(M,2),G=V[0],z=V[1],H=c.a.useState(null),q=Object(h.a)(H,2),K=q[0],J=q[1],$=c.a.useState(null),Y=Object(h.a)($,2),X=Y[0],ee=Y[1],ae=c.a.useState(!1),ne=Object(h.a)(ae,2),re=ne[0],ce=ne[1],ie=function(){z(null),J(null)},oe=function(){i(!1),j(null),g(null),ie(),T(""),k(""),D(""),F(o[0]||"")};c.a.useEffect((function(){var e=!0;return d&&v&&W?Object(U.a)(B.a.mark((function e(){var t;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,ce(!0),e.next=4,te.a.post("/api/delivery/check",{from:d,to:v,mode:W});case 4:t=e.sent,console.log("Price & Disctance",t.data),z(t.data.distance),J(t.data.price),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("Price Error",e.t0),s("Oops! Couldn't calculate price","error");case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))():(console.log("Fill form..."),ie()),e&&ce(!1),function(){e=!1}}),[d,v,W,r,s]);var se=function(){var e=Object(U.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(X&&d&&v&&W&&C&&E&&K&&G)){e.next=12;break}return e.prev=1,e.next=4,te.a.post("/api/admin/delivery",{client:X,from:d,to:v,mode:W,pickUpNumber:C,dropOffNumber:E,note:R,price:K,distance:G});case 4:oe(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log("Error...",e.t0);case 10:e.next=13;break;case 12:console.log("Please fill in all fields");case 13:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}();return Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsx)(O.a,{px:1}),Object(n.jsx)(f.a,{color:"secondary",onClick:function(){return i(!0)},children:"Create New"}),Object(n.jsxs)(at.a,{open:r,onClose:oe,"aria-labelledby":"new-delivery",maxWidth:"lg",children:[Object(n.jsx)(nt.a,{id:"new-delivery",children:"New Delivery"}),Object(n.jsx)(rt.a,{children:Object(n.jsxs)(O.a,{width:700,height:300,p:1,display:"flex",flexDirection:"row",children:[Object(n.jsxs)(Q.a,{container:!0,spacing:3,children:[Object(n.jsx)(Q.a,{item:!0,xs:12,md:6,children:Object(n.jsx)(gt,{label:"Client",onChange:function(e){return ee(e?e._id:null)}})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:6,children:Object(n.jsx)(ct.a,{fullWidth:!0,variant:"outlined",label:"Mode",value:W,onChange:function(e){return F(e.target.value)},children:o.map((function(e,t){return Object(n.jsx)(it.a,{value:e,children:e},t)}))})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:6,children:Object(n.jsx)(mt,{label:"Pickup Location",onChange:function(e){return j(e)}})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:6,children:Object(n.jsx)(m.a,{id:"pickupphone",label:"Pickup Contact",value:C,onChange:function(e){return k(e.target.value)},variant:"outlined",fullWidth:!0})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:6,children:Object(n.jsx)(mt,{label:"Dropoff Location",onChange:function(e){return g(e)}})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:6,children:Object(n.jsx)(m.a,{id:"dropoffphone",label:"Dropoff Contact",value:E,onChange:function(e){return D(e.target.value)},variant:"outlined",fullWidth:!0})}),Object(n.jsx)(Q.a,{item:!0,xs:12,children:Object(n.jsx)(m.a,{id:"note",label:"Note",variant:"outlined",fullWidth:!0,value:R,onChange:function(e){return T(e.target.value)}})})]}),Object(n.jsx)(Z.a,{style:{marginLeft:15,height:"100%"},variant:"outlined",children:Object(n.jsxs)(O.a,{p:5,width:300,height:1,children:[Object(n.jsx)(p.a,{variant:"body1",color:"initial",gutterBottom:!0,children:"Distance"}),Object(n.jsx)(O.a,{display:"flex",flexDirection:"row",alignItems:"center",children:Object(n.jsx)(p.a,{variant:"h3",color:"initial",gutterBottom:!0,children:G||"0 km"})}),Object(n.jsx)(je.a,{style:{marginBottom:15}}),Object(n.jsx)(p.a,{variant:"body1",color:"initial",gutterBottom:!0,children:"Price"}),Object(n.jsx)(p.a,{variant:"h3",color:"initial",gutterBottom:!0,noWrap:!0,children:wt(K)})]})})]})}),Object(n.jsxs)(ot.a,{children:[Object(n.jsx)(f.a,{onClick:se,color:"primary",disabled:!(X&&d&&v&&W&&C&&E&&K&&G&&!re),children:"Create"}),Object(n.jsx)(f.a,{onClick:oe,color:"default",children:"Cancel"})]})]})]})},At=function(e){var t=c.a.useState([]),a=Object(h.a)(t,2),r=a[0],i=a[1],o=c.a.useState([]),s=Object(h.a)(o,2),l=s[0],u=s[1],d=c.a.useState([]),j=Object(h.a)(d,2),b=j[0],f=j[1],x=c.a.useState([]),m=Object(h.a)(x,2),v=m[0],g=m[1],y=c.a.useState([]),w=Object(h.a)(y,2),C=w[0],k=w[1],S=c.a.useState(0),N=Object(h.a)(S,2),E=N[0],D=N[1],I=c.a.useState(!1),A=Object(h.a)(I,2),R=A[0],T=A[1],P=c.a.useContext(tt),_=P.newOrder,L=P.clearNewOrder;c.a.useEffect((function(){W(),L()}),[]),c.a.useEffect((function(){_&&(W(),setTimeout(L,1e4))}),[_,L]);var W=function(){var e=Object(U.a)(B.a.mark((function e(){var t,a;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T(!0),e.prev=1,e.next=4,te.a.get("/api/admin/deliveries");case 4:t=e.sent,a=t.data,i(a.filter((function(e){return"Pending"===e.status}))),u(a.filter((function(e){return"Processing"===e.status}))),g(a.filter((function(e){return"Cancelled"===e.status}))),f(a.filter((function(e){return"Delivered"===e.status}))),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:T(!1);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}(),F=function(e){return e.map((function(e){var t=e.dateCreated,a=e.client,n=e.from,r=e.to,c=e.distance,i=e.mode,o=e._id,s=n&&n.address,l=r&&r.address;return{dateCreated:t,client:(a||{name:""}).name,pickUp:s,dropOff:l,distance:c,mode:i,_id:o}}))};return c.a.useEffect((function(){switch(E){case 0:k(F(r));break;case 1:k(F(l));break;case 2:k(F(b));break;case 3:k(F(v))}}),[E,R,r,l,b,v]),Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsxs)(O.a,{display:"flex",flexDirection:"row",mb:3,children:[Object(n.jsx)(p.a,{variant:"h5",color:"initial",gutterBottom:!0,children:"Deliveries"}),Object(n.jsx)(It,{})]}),Object(n.jsx)($e,{aria:"deliveries tab",tabs:["Pending","Processing","Delivered","Cancelled"],onChange:function(e){return D(e)}}),Object(n.jsx)(et,{rows:C,columns:St,getRowId:function(e){return e._id},columnExtensions:Nt,formatters:[Object(n.jsx)(Dt,{for:["dateCreated"]})],onClick:function(t){e.history.push("/dashboard/delivery/".concat(t))},loading:R})]})},Rt=a(8),Tt=a(270),Pt=a.n(Tt),_t=a(271),Lt=a.n(_t),Wt=a(272),Ft=a.n(Wt),Mt=a(474),Bt=a(97),Ut=a(239),Vt=a.n(Ut),Gt=a(151),zt=a(172),Ht=a(475),Qt=a(178),Zt={pulse:{animation:"x 1s infinite ease-in-out",animationName:Gt.a.keyframes(Vt.a,"pulse")}},qt=Object(He.a)((function(e){return{arrow:{color:e.palette.common.black},tooltip:{backgroundColor:e.palette.common.black,color:e.palette.primary.contrastText,boxShadow:e.shadows[1],fontSize:11}}}))(Qt.a),Kt=function(e){var t=e.lat,a=e.lng,r=e.src,i=e.name,o=e.action,s=e.to,l=e.id,d=e.animate,j=e.onClick,b=d?Zt.pulse:{};return Object(n.jsx)(c.a.Fragment,{children:Object(n.jsx)("div",{lat:t,lng:a,children:Object(n.jsx)(zt.a,{children:Object(n.jsx)(qt,{interactive:!0,arrow:!0,placement:"top-end",title:Object(n.jsxs)(O.a,{display:"flex",p:1,alignContent:"center",children:[Object(n.jsx)(O.a,{pr:2,children:i}),Object(n.jsx)(p.a,{variant:"body2",color:"secondary",style:{textDecoration:"none"},component:u.b,onClick:j,to:s,children:o})]}),children:Object(n.jsx)("div",{style:b,children:Object(n.jsx)(Ht.a,{src:r,"aria-describedby":l})})})})})})},Jt=a(268),$t=a.n(Jt),Yt=a(269),Xt=a.n(Yt),ea={bounce:{animation:"x 3s infinite ease-in-out",animationName:Gt.a.keyframes($t.a,"bounce")}},ta=Object(He.a)((function(e){return{arrow:{color:e.palette.common.black},tooltip:{backgroundColor:e.palette.common.black,color:e.palette.primary.contrastText,boxShadow:e.shadows[1],fontSize:11}}}))(Qt.a),aa=function(e){var t=e.lat,a=e.lng,r=e.color,i=e.address,o=e.id,s=e.animate,l=e.label,u=s?ea.bounce:{},d=c.a.useState(!1),j=Object(h.a)(d,2),b=j[0],f=j[1];return Object(n.jsx)(c.a.Fragment,{children:Object(n.jsx)("div",{lat:t,lng:a,children:Object(n.jsx)(zt.a,{children:Object(n.jsx)(ta,{arrow:!0,placement:"top-end",title:Object(n.jsx)(O.a,{display:"flex",p:1,alignContent:"center",children:Object(n.jsxs)(O.a,{pr:2,children:[l&&Object(n.jsx)(p.a,{variant:"caption",color:"primary",children:"".concat(l,": ")}),i]})}),children:Object(n.jsx)("div",{style:b?{}:u,onMouseOver:function(){return f(!0)},onMouseEnter:function(){return f(!0)},onMouseLeave:function(){return f(!1)},children:Object(n.jsx)(O.a,{color:r||"secondary",children:Object(n.jsx)(Xt.a,{fontSize:"large",color:"inherit","aria-describedby":i&&o})})})})})})})},na=a(402),ra=a(223),ca=Object(J.a)((function(e){return{distance:{color:e.palette.text.primary,position:"relative",bottom:"60vh",zIndex:100,padding:e.spacing(2)}}})),ia=function(){var e=c.a.useContext(yt).markers,t=ca(),a=Object(d.h)().id,r=function(e){var t=e.mode,a=Object(Rt.a)(e,["mode"]);switch(t){case"Motorcycle":return Object(n.jsx)(Pt.a,Object(x.a)({},a));case"Car":return Object(n.jsx)(Lt.a,Object(x.a)({},a));case"Minivan":return Object(n.jsx)(Ft.a,Object(x.a)({},a));default:return Object(n.jsx)(c.a.Fragment,{})}},i=c.a.useState(0),o=Object(h.a)(i,2),s=(o[0],o[1],c.a.useState(!1)),l=Object(h.a)(s,2),j=l[0],b=l[1],m=c.a.useState(!1),v=Object(h.a)(m,2),g=v[0],y=v[1],w=c.a.useState(null),C=Object(h.a)(w,2),k=C[0],S=C[1],N=c.a.useState({client:null,dateCreated:null,distance:null,from:null,mode:null,price:null,status:null,to:null,track:[],driver:null,driverComment:[]}),E=Object(h.a)(N,2),D=E[0],I=E[1],A=D.client,R=(D.dateCreated,D.distance),T=D.from,P=D.mode,_=D.price,L=D.status,W=D.to,F=D.track,M=D.driver;D.driverComment;console.log("Delivery..",D);var V=c.a.useState(null),G=Object(h.a)(V,2),z=G[0],H=G[1],Q=function(){H(null)},Z=function(){return S(null)},q=function(){var e=Object(U.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te.a.post("/api/admin/delivery/status",{status:t,id:a});case 3:I(Object(x.a)(Object(x.a)({},D),{},{status:t})),Z(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();c.a.useEffect((function(){K()}),[]);var K=function(){var e=Object(U.a)(B.a.mark((function e(){var t;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.prev=1,e.next=4,te.a.get("/api/delivery/".concat(a));case 4:t=e.sent,I(t.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:b(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=Object(U.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Driver...",t),e.next=4,te.a.post("/api/admin/delivery/assign",{id:a,driverID:t._id,reassign:D.driver});case 4:I(Object(x.a)(Object(x.a)({},D),{},{status:"Processing",driver:t})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return j?Object(n.jsxs)(O.a,{alignItems:"center",justifyContent:"center",display:"flex",height:"100%",children:[Object(n.jsx)(na.a,{}),Object(n.jsx)(p.a,{variant:"subtitle1",color:"initial",children:"Loading..."})]}):Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsx)(O.a,{display:"flex",flexDirection:"row",mb:3,children:Object(n.jsx)(p.a,{variant:"h5",color:"initial",gutterBottom:!0,children:"Delivery Info"})}),Object(n.jsxs)(O.a,{display:"flex",flexDirection:"row",children:[Object(n.jsx)(p.a,{variant:"subtitle1",color:"initial",children:"ID: "+a}),Object(n.jsx)(O.a,{width:100}),Object(n.jsx)(p.a,{variant:"subtitle1",color:"initial",children:"Mode:"}),Object(n.jsx)(O.a,{width:10}),P&&Object(n.jsx)(r,{color:"primary",mode:P}),Object(n.jsx)(O.a,{width:100}),Object(n.jsx)(p.a,{variant:"subtitle1",color:"initial",children:_&&"Price:  "+wt(_)}),Object(n.jsx)(O.a,{width:100}),L&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(p.a,{variant:"subtitle1",color:"initial",children:"Status"}),Object(n.jsx)(O.a,{width:10}),Object(n.jsx)(Mt.a,{label:L,color:"secondary",onClick:function(e){H(e.currentTarget)}}),Object(n.jsx)(ra.a,{id:"status-change",anchorEl:z,keepMounted:!0,open:Boolean(z),onClose:Q,children:["Pending","Processing","Delivered","Cancelled"].map((function(e){return L!==e?Object(n.jsx)(it.a,{onClick:function(){Q(),S(e)},children:e},e):null}))})]})]}),Object(n.jsxs)(O.a,{height:"60vh",my:3,children:[Object(n.jsxs)(Bt.a,{bootstrapURLKeys:{key:"AIzaSyAVa67y3wWEBxeAR5Q0p4PZtVknjarOlhQ"},defaultCenter:{lat:4.8156,lng:7.0498},defaultZoom:10,children:[["Pending","Processing"].includes(L)&&e.map((function(e,t){return Object(n.jsx)(Kt,{lat:e.latitude,lng:e.longitude,src:e.photoUrl,name:e.name,action:M?"Re-assign":"Assign",id:e._id,animate:!0,onClick:function(){console.log(e),J(e)}},t)})),W&&W.address&&Object(n.jsx)(aa,{lat:W.latitude,lng:W.longitude,color:"secondary.main",label:"To",address:W.address,id:"to",animate:!0}),T&&T.address&&Object(n.jsx)(aa,{lat:T.latitude,lng:T.longitude,color:"primary.main",label:"From",address:T.address,id:"from",animate:!0})]}),Object(n.jsx)(O.a,{children:Object(n.jsx)(p.a,{variant:"h4",color:"textSecondary",className:t.distance,children:R})})]}),Object(n.jsxs)(O.a,{display:"flex",flexDirection:"row",alignItems:"center",children:[Object(n.jsx)(f.a,{variant:"contained",color:"secondary",onClick:function(){return y(!0)},children:"Track Order"}),Object(n.jsx)(O.a,{display:"flex",flexGrow:1}),A&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(p.a,{variant:"subtitle2",children:" Client: "}),Object(n.jsx)(O.a,{width:5}),Object(n.jsx)(p.a,{variant:"subtitle2",component:u.b,to:"/dashboard/client/".concat(A._id),color:"textPrimary",children:A.name})]}),M&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(O.a,{width:15}),Object(n.jsx)(p.a,{variant:"subtitle2",children:" Driver: "}),Object(n.jsx)(O.a,{width:5}),Object(n.jsx)(p.a,{variant:"subtitle2",component:u.b,to:"/dashboard/driver/".concat(M._id),color:"textPrimary",children:M.name})]}),Object(n.jsxs)(at.a,{open:k,onClose:Z,children:[Object(n.jsx)(rt.a,{children:Object(n.jsx)(p.a,{variant:"subtitle1",color:"initial",children:"Are you sure you want to set this delivery to ".concat(k,".")})}),Object(n.jsxs)(ot.a,{children:[Object(n.jsx)(f.a,{variant:"text",color:"primary",onClick:function(){return q(k)},children:"Yes"}),Object(n.jsx)(f.a,{variant:"text",color:"default",onClick:Z,children:"No"})]})]}),Object(n.jsxs)(at.a,{maxWidth:"sm",fullWidth:!0,open:g,onClose:function(){return y(!1)},children:[Object(n.jsx)(nt.a,{children:"Activity tracking"}),Object(n.jsx)(rt.a,{children:Object(n.jsx)(ue.a,{children:F.map((function(e,t){return Object(n.jsx)(me.a,{children:Object(n.jsx)(ge.a,{primary:Object(n.jsx)(p.a,{variant:"subtitle1",color:"initial",children:e.action}),secondary:new Date(e.timestamp).toUTCString()})},t)}))})})]})]})]})},oa=[{name:"photoUrl",title:" "},{name:"name",title:"Name"},{name:"staffID",title:"Staff ID"},{name:"phone",title:"Phone"},{name:"email",title:"Email"}],sa=[{columnName:"photoUrl",width:100,align:"center"},{columnName:"name"},{columnName:"staffID"},{columnName:"phone"},{columnName:"email"}],la=function(e){var t=e.value;return Object(n.jsx)(Ht.a,{alt:"Driver image",src:t})},ua=function(e){return Object(n.jsx)(Xe.b,Object(x.a)({formatterComponent:la},e))},da=function(){var e=c.a.useState(!1),t=Object(h.a)(e,2),a=t[0],r=t[1],i=c.a.useState(""),o=Object(h.a)(i,2),s=o[0],l=o[1],u=c.a.useState(""),d=Object(h.a)(u,2),j=d[0],b=d[1],p=c.a.useState(""),x=Object(h.a)(p,2),v=x[0],g=x[1],y=c.a.useState(""),w=Object(h.a)(y,2),C=w[0],k=w[1],S=c.a.useState(""),N=Object(h.a)(S,2),E=N[0],D=N[1],I=c.a.useState(""),A=Object(h.a)(I,2),R=A[0],T=A[1],P=c.a.useState(""),_=Object(h.a)(P,2),L=_[0],W=_[1],F=c.a.useState(!1),M=Object(h.a)(F,2),V=M[0],G=M[1],z=c.a.useState(!1),H=Object(h.a)(z,2),q=H[0],K=H[1],J=function(){r(!1)},$=function(){var e=Object(U.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!V&&s&&R&&j&&L&&C&&E&&v)){e.next=13;break}return e.prev=1,K(!0),e.next=5,te.a.post("/api/drivers",{photoUrl:s,password:R,name:j,secret:L,phone:C,staffID:E,email:v});case 5:r(""),l(""),b(""),g(""),k(""),D(""),T(""),W(""),J(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("Create Error...",e.t0);case 12:K(!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();return Object(n.jsx)(c.a.Fragment,{children:Object(n.jsxs)(O.a,{px:1,children:[Object(n.jsx)(f.a,{color:"secondary",onClick:function(){return r(!0)},children:"Create New"}),Object(n.jsxs)(at.a,{open:a,onClose:J,"aria-labelledby":"new-driver",maxWidth:"lg",children:[Object(n.jsx)(nt.a,{id:"new-driver",children:"New Driver"}),Object(n.jsx)(rt.a,{children:Object(n.jsxs)(O.a,{width:700,height:300,p:1,display:"flex",flexDirection:"row",children:[Object(n.jsxs)(Q.a,{container:!0,spacing:3,children:[Object(n.jsx)(Q.a,{item:!0,xs:12,children:Object(n.jsx)(m.a,{id:"driver-name",label:"Name",variant:"outlined",fullWidth:!0,value:j,onChange:function(e){return b(e.target.value)}})}),Object(n.jsx)(Q.a,{item:!0,xs:12,children:Object(n.jsx)(m.a,{id:"driver-email",label:"Email",variant:"outlined",fullWidth:!0,value:v,onChange:function(e){return g(e.target.value)}})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:6,children:Object(n.jsx)(m.a,{id:"driver-phone",label:"Phone",variant:"outlined",fullWidth:!0,value:C,onChange:function(e){return k(e.target.value)}})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:6,children:Object(n.jsx)(m.a,{id:"driver-id",label:"StaffID",variant:"outlined",fullWidth:!0,value:E,onChange:function(e){return D(e.target.value)}})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:6,children:Object(n.jsx)(m.a,{id:"driver-password",label:"Password",variant:"outlined",type:"password",fullWidth:!0,value:R,onChange:function(e){return T(e.target.value)}})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:6,children:Object(n.jsx)(m.a,{id:"secret",label:"Secret",variant:"outlined",type:"password",fullWidth:!0,value:L,onChange:function(e){return W(e.target.value)}})})]}),Object(n.jsx)(Z.a,{style:{marginLeft:15,height:"100%"},variant:"outlined",children:Object(n.jsxs)(O.a,{p:5,width:300,height:1,children:[V&&s?Object(n.jsx)("img",{style:{borderRadius:75},mode:"cover",height:150,width:150,src:"https://www.flaticon.com/svg/vstatic/svg/1481/1481932.svg?token=exp=1614329867~hmac=6a1aaf9b6469a7538a88cd67c08ed57d",alt:"Feedback"}):Object(n.jsx)("img",{onError:function(){return G(!0)},onLoad:function(){G(!1)},style:{borderRadius:75},mode:"cover",height:150,width:150,src:s||"https://www.flaticon.com/svg/vstatic/svg/727/727399.svg?token=exp=1614329769~hmac=e631322c93b0fb47d1138094522c2b5a",alt:"Driver"}),Object(n.jsx)(m.a,{id:"photoUrl",label:"Profile photo URL",variant:"standard",value:s,onChange:function(e){return l(e.target.value)},fullWidth:!0})]})})]})}),Object(n.jsxs)(ot.a,{children:[Object(n.jsx)(f.a,{color:"primary",disabled:V||q||!(s&&R&&j&&L&&C&&E&&v),onClick:$,children:"Create"}),Object(n.jsx)(f.a,{onClick:J,color:"default",children:"Cancel"})]})]})]})})},ja=function(e){c.a.useEffect((function(){A()}),[]);var t=c.a.useState([]),a=Object(h.a)(t,2),r=a[0],i=a[1],o=c.a.useState([]),s=Object(h.a)(o,2),l=s[0],u=s[1],d=c.a.useState([]),j=Object(h.a)(d,2),b=j[0],f=j[1],x=c.a.useState([]),m=Object(h.a)(x,2),v=m[0],g=m[1],y=c.a.useState(0),w=Object(h.a)(y,2),C=w[0],k=w[1],S=c.a.useState(!1),N=Object(h.a)(S,2),E=N[0],D=N[1],I=c.a.useContext(yt).markers,A=function(){var e=Object(U.a)(B.a.mark((function e(){var t,a;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(!0),e.prev=1,e.next=4,te.a.get("/api/admin/drivers");case 4:t=e.sent,a=t.data,i(a.filter((function(e){return!e.valid&&!e.banned}))),u(a.filter((function(e){return e.valid&&!e.banned}))),f(a.filter((function(e){return e.banned}))),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:D(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();c.a.useEffect((function(){switch(C){case 0:g(l);break;case 1:g(r);break;case 2:g(b)}}),[C,E,r,l,b]);var R=Object(n.jsx)(et,{rows:v,columns:oa,getRowId:function(e){return e._id},formatters:[Object(n.jsx)(ua,{for:["photoUrl"]})],columnExtensions:sa,loading:E,onClick:function(t){e.history.push("/dashboard/driver/".concat(t))}}),T=Object(n.jsx)(O.a,{width:"100%",style:{height:500},children:Object(n.jsx)(Bt.a,{bootstrapURLKeys:{key:"AIzaSyAVa67y3wWEBxeAR5Q0p4PZtVknjarOlhQ"},defaultCenter:{lat:4.8156,lng:7.0498},defaultZoom:15,children:I.map((function(e){return Object(n.jsx)(Kt,{lat:e.latitude,lng:e.longitude,src:e.photoUrl,name:e.name,id:e._id,action:"View",to:"/dashboard/driver/".concat(e._id),animate:!0})}))})});return Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsxs)(O.a,{display:"flex",flexDirection:"row",mb:3,children:[Object(n.jsx)(p.a,{variant:"h5",color:"initial",gutterBottom:!0,children:"Drivers"}),Object(n.jsx)(da,{})]}),Object(n.jsx)($e,{aria:"deliveries tab",tabs:["Active","Pending","Blacklist","Map"],onChange:function(e){return k(e)}}),3===C?T:R]})},ba=a(464),ha=a(273),Oa=a.n(ha),fa=Object(J.a)((function(e){var t;return{avatar:(t={marginRight:e.spacing(1)},Object(re.a)(t,e.breakpoints.down("md"),{height:e.spacing(10),width:e.spacing(10)}),Object(re.a)(t,e.breakpoints.up("md"),{height:e.spacing(7),width:e.spacing(7)}),Object(re.a)(t,e.breakpoints.up("lg"),{height:e.spacing(10),width:e.spacing(10)}),t),card:{width:"100%"},primary:{backgroundColor:e.palette.primary.main},primaryText:{color:e.palette.primary.contrastText}}})),pa=function(e){var t=fa(),a=Object(d.h)().id,i=Object(r.useContext)(yt).drivers,o=c.a.useState(null),s=Object(h.a)(o,2),l=s[0],u=s[1],j=c.a.useState(!1),b=Object(h.a)(j,2),m=b[0],v=b[1],g=c.a.useState(!1),y=Object(h.a)(g,2),w=y[0],C=y[1],k=c.a.useState(0),S=Object(h.a)(k,2),N=S[0],E=S[1],D=c.a.useState([]),I=Object(h.a)(D,2),A=I[0],P=I[1],_=c.a.useState([]),L=Object(h.a)(_,2),W=L[0],F=L[1],M=c.a.useState([]),V=Object(h.a)(M,2),G=V[0],z=V[1],q=c.a.useState([]),K=Object(h.a)(q,2),J=K[0],$=K[1],Y=function(e){var t=e.value;return new Date(t).toLocaleDateString()},ee=function(e){return Object(n.jsx)(Xe.b,Object(x.a)({formatterComponent:Y},e))},ae=c.a.useState([]),ne=Object(h.a)(ae,2),re=ne[0],ce=ne[1],ie=c.a.useState([]),oe=Object(h.a)(ie,2),se=oe[0],le=oe[1],de=c.a.useState([]),be=Object(h.a)(de,2),he=be[0],Oe=be[1],fe=c.a.useState([]),pe=Object(h.a)(fe,2),xe=pe[0],ve=pe[1],ye=c.a.useState({}),we=Object(h.a)(ye,2),Ce=we[0],ke=we[1],Se=c.a.useState(!0),Ne=Object(h.a)(Se,2),Ee=Ne[0],De=Ne[1],Ie=c.a.useState({delivered:0,cancelled:0}),Ae=Object(h.a)(Ie,2),Re=Ae[0],Te=Ae[1],Pe=function(){var e=Object(U.a)(B.a.mark((function e(){var t,n,r,c;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return De(!0),e.prev=1,e.next=4,te.a.get("/api/admin/driver/".concat(a));case 4:t=e.sent,ke(t.data),t.data.performance.deliveries.weekly&&ce(R(t.data.performance.deliveries.weekly)),t.data.performance.deliveries.monthly&&le(T(t.data.performance.deliveries.monthly)),n=t.data.performance,r=n.day.find((function(e){return"Deliveries"===e._id}))||{total:0,revenue:0},c=n.day.find((function(e){return"Cancelled"===e._id}))||{total:0,revenue:0},Te({delivered:r.total,cancelled:c.total}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0);case 17:De(!1);case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(){return e.apply(this,arguments)}}();c.a.useEffect((function(){ve(re.map((function(e){return e[0]}))),Oe(se.map((function(e){return e[0]})))}),[re,se]),c.a.useEffect((function(){Pe(),_e()}),[]),c.a.useEffect((function(){u(i[a])}),[i,a]);var _e=function(){var e=Object(U.a)(B.a.mark((function e(){var t,n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(!0),e.prev=1,e.next=4,te.a.get("/api/admin/driver/deliveries/".concat(a));case 4:t=e.sent,n=t.data,P(n.filter((function(e){return"Processing"===e.status}))),z(n.filter((function(e){return"Cancelled"===e.status}))),F(n.filter((function(e){return"Delivered"===e.status}))),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:C(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}(),Le=function(e){return e.map((function(e){var t=e.dateCreated,a=e.client,n=e.from,r=e.to,c=e.distance,i=e.mode,o=e._id,s=n&&n.address,l=r&&r.address;return{dateCreated:t,client:(a||{name:""}).name,pickUp:s,dropOff:l,distance:c,mode:i,_id:o}}))};return c.a.useEffect((function(){switch(N){case 0:$(Le(A));break;case 1:$(Le(W));break;case 2:$(Le(G))}}),[N,Ee,A,W,G]),Ee?Object(n.jsx)(O.a,{alignItems:"center",justifyContent:"center",display:"flex",height:"100%",children:Object(n.jsx)(na.a,{})}):Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsx)(O.a,{display:"flex",flexDirection:"row",mb:3,children:Object(n.jsx)(p.a,{variant:"h5",color:"initial",gutterBottom:!0,children:"Driver"})}),Object(n.jsxs)(Q.a,{container:!0,spacing:3,children:[Object(n.jsxs)(Q.a,{item:!0,xs:6,md:3,children:[Object(n.jsxs)(Z.a,{style:{maxWidth:300},children:[Object(n.jsx)(O.a,{p:2,children:Object(n.jsxs)(Q.a,{container:!0,spacing:2,justify:"flex-start",alignItems:"center",children:[Object(n.jsx)(Q.a,{item:!0,xs:4,children:Object(n.jsx)(Ht.a,{className:t.avatar,src:Ce.photoUrl})}),Object(n.jsxs)(Q.a,{item:!0,xs:8,justify:"flex-start",children:[Object(n.jsx)(p.a,{variant:"h6",color:"secondary",noWrap:!0,children:Ce.name}),Object(n.jsx)(p.a,{variant:"body2",color:"initial",noWrap:!0,children:"Staff ID: ".concat(Ce.staffID)})]})]})}),Object(n.jsx)(je.a,{}),Object(n.jsxs)(ue.a,{children:[Object(n.jsxs)(me.a,{children:[Object(n.jsx)(ge.a,{primary:"Email",secondary:Ce.email}),Object(n.jsx)(ba.a,{children:Object(n.jsx)(Oa.a,{})})]}),Object(n.jsxs)(me.a,{children:[Object(n.jsx)(ge.a,{primary:"Phone",secondary:Ce.phone}),Object(n.jsx)(ba.a,{children:Object(n.jsx)(f.a,{variant:"text",color:"secondary",onClick:function(){return v(!0)},children:"View Orders"})})]})]})]}),Object(n.jsxs)(O.a,{mt:5,children:[Object(n.jsx)(p.a,{variant:"body2",color:"initial",gutterBottom:!0,children:"Today"}),Object(n.jsx)(Z.a,{className:Object(H.a)([t.card,t.primary]),children:Object(n.jsxs)(O.a,{p:2,children:[Object(n.jsx)(p.a,{variant:"h6",color:"textPrimary",className:t.primaryText,children:"Sales"}),Object(n.jsx)(O.a,{height:30}),Object(n.jsxs)(p.a,{variant:"body1",color:"textSecondary",className:t.primaryText,children:[Re.delivered," Delivered"]}),Object(n.jsxs)(p.a,{variant:"body1",color:"textSecondary",className:t.primaryText,children:[Re.cancelled," Cancelled"]})]})})]})]}),Object(n.jsxs)(Q.a,{item:!0,xs:6,md:4,children:[Object(n.jsx)(p.a,{variant:"body2",color:"initial",gutterBottom:!0,children:"This week"}),Object(n.jsx)(X,{data:xe,argument:"date",lineValues:["sales","cancelled"]}),Object(n.jsxs)(O.a,{mt:5,children:[Object(n.jsx)(p.a,{variant:"body2",color:"initial",gutterBottom:!0,children:"Monthly"}),Object(n.jsx)(X,{data:he,argument:"date",barValues:["sales","cancelled"]})]})]}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:5,children:Object(n.jsx)(O.a,{height:550,width:1,children:Object(n.jsx)(Bt.a,{bootstrapURLKeys:{key:"AIzaSyAVa67y3wWEBxeAR5Q0p4PZtVknjarOlhQ"},defaultCenter:{lat:4.8156,lng:7.0498},center:{lat:l?l.latitude:4.8156,lng:l?l.longitude:7.0498},defaultZoom:15,children:l&&Object(n.jsx)(Kt,{lat:l.latitude,lng:l.longitude,src:l.photoUrl,name:l.name,id:a,animate:!0})})})})]}),Object(n.jsxs)(at.a,{maxWidth:"lg",open:m,onClose:function(){return v(!1)},children:[Object(n.jsx)(nt.a,{children:"Orders"}),Object(n.jsx)(rt.a,{children:Object(n.jsxs)(O.a,{children:[Object(n.jsx)($e,{aria:"deliveries tab",tabs:["Processing","Delivered","Cancelled"],onChange:function(e){return E(e)}}),Object(n.jsx)(et,{rows:J,columns:[{name:"dateCreated",title:"Date Created"},{name:"client",title:"Client"},{name:"pickUp",title:"Pick-up"},{name:"dropOff",title:"Drop-off"},{name:"distance",title:"Distance (km)"},{name:"mode",title:"Mode"}],getRowId:function(e){return e._id},columnExtensions:[{columnName:"distance",width:120,align:"center"}],formatters:[Object(n.jsx)(ee,{for:["dateCreated"]})],onClick:function(t){e.history.push("/dashboard/delivery/".concat(t))},loading:w})]})})]})]})},xa=a(274),ma=a.n(xa),va=a(406),ga=a(407),ya=Object(r.createContext)(),wa=function(e){return e.id},Ca=function(e){var t=e.onClick,a=Object(Rt.a)(e,["onClick"]);return Object(n.jsx)(Ye.b.Cell,Object(x.a)(Object(x.a)({},a),{},{tabIndex:0,onFocus:t}))},ka=function(e){var t=e.columns,a=e.rowsStart,i=e.columnExtensions,o=e.onClose,s=e.open,l=e.mode,u=e.setMatrix,d=Object(r.useState)([]),j=Object(h.a)(d,2),b=j[0],p=j[1],m=Object(r.useState)([]),v=Object(h.a)(m,2),g=v[0],y=v[1],w=Object(r.useState)(!1),C=Object(h.a)(w,2),k=C[0],S=C[1],N=Object(r.useContext)(P).setAlert;c.a.useEffect((function(){Array.isArray(a)&&s?p(a.map((function(e,t){return Object(x.a)(Object(x.a)({},e),{},{id:e.id||t})}))):p([])}),[s]);var E=function(){var e=Object(U.a)(B.a.mark((function e(){var t;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(!0),e.prev=1,t=b.map((function(e){var t=Number(e.price),a=Number(e.distance);if(isNaN(a)||isNaN(t))throw Error("Invalid Price or Distance value");return{id:e.id,price:t,distance:a}})).sort((function(e,t){return e.distance-t.distance})),e.next=5,te.a.post("/api/admin/price",{priceList:t,mode:l});case 5:u(t),o(),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),N("Please review Price List","error");case 13:S(!1);case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),D=function(e){var a,n=e.added,r=e.changed,c=e.deleted;if(n){var i=b.length>0?Math.max(b[b.length-1].id,b[0].id)+1:0;a=[].concat(Object(st.a)(n.map((function(e,t){return Object(x.a)({id:i+t},e)}))),Object(st.a)(b)),y([{rowId:i,columnName:t[0].name}])}if(r&&(a=b.map((function(e){return r[e.id]?Object(x.a)(Object(x.a)({},e),r[e.id]):e}))),c){var o=new Set(c);a=b.filter((function(e){return!o.has(e.id)}))}p(a)};return Object(n.jsxs)(at.a,{open:s,onClose:o,children:[Object(n.jsx)(rt.a,{children:Object(n.jsx)(O.a,{minHeight:500,children:Object(n.jsxs)(Ye.a,{rows:b,columns:t,getRowId:wa,children:[Object(n.jsx)(Xe.d,{onCommitChanges:D,editingCells:g,onEditingCellsChange:y,addedRows:[],onAddedRowsChange:function(){return D({added:[{}]})}}),Object(n.jsx)(Ye.b,{cellComponent:Ca,columnExtensions:i}),Object(n.jsx)(Ye.d,{}),Object(n.jsx)(Ye.e,{selectTextOnEditStart:!0}),Object(n.jsx)(Ye.c,{showAddCommand:!0,showDeleteCommand:!0})]})})}),Object(n.jsxs)(ot.a,{children:[Object(n.jsx)(f.a,{color:"primary",onClick:E,disabled:k,children:"Submit"}),Object(n.jsx)(f.a,{color:"default",onClick:o,disabled:k,children:"Cancel"})]})]})},Sa=[{name:"distance",title:"Distance (km)"},{name:"price",title:"Price (#)"}],Na=[{columnName:"distance",align:"left"},{columnName:"price",width:120,align:"right"}],Ea=function(){var e=Object(r.useContext)(yt).modes,t=Object(r.useContext)(ya).switchModes,a=c.a.useState([]),i=Object(h.a)(a,2),o=i[0],s=i[1],l=c.a.useState([]),u=Object(h.a)(l,2),d=u[0],j=u[1],b=c.a.useState([]),f=Object(h.a)(b,2),x=f[0],m=f[1],v=function(){var e=Object(U.a)(B.a.mark((function e(){var t,a,n,r,c;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te.a.get("/api/admin/price_matrix");case 3:t=e.sent,a=t.data,n=a.motorcycle,r=a.car,c=a.minivan,console.log("data",n,r,c),n&&s(n.priceList),r&&j(r.priceList),c&&m(c.priceList),console.log(t.data),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();c.a.useEffect((function(){return Object(U.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",v());case 1:case"end":return e.stop()}}),e)})))()}),[]);var g=function(e){var t=e.mode,a=c.a.useState(!1),r=Object(h.a)(a,2),i=r[0],l=r[1],u=function(){switch(t){case"Motorcycle":return o;case"Car":return d;case"Mini Van":return x;default:return[]}}(),b=function(){switch(t){case"Motorcycle":return s;case"Car":return j;case"Mini Van":return m;default:return function(){console.log("no mode")}}}(),f=c.a.useState([]),p=Object(h.a)(f,2),v=p[0],g=p[1];return Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsx)(et,{rows:u,columns:Sa,columnExtensions:Na,footer:Object(n.jsx)(O.a,{width:1,p:1,display:"flex",justifyContent:"flex-end",children:Object(n.jsx)(W.a,{onClick:function(){g(u),l(!0)},children:Object(n.jsx)(ma.a,{})})})}),Object(n.jsx)(ka,{rowsStart:v,columnExtensions:Na,columns:Sa,open:i,onClose:function(){return l(!1)},mode:t,setMatrix:b})]})};return Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsx)(O.a,{display:"flex",flexDirection:"row",mb:3,children:Object(n.jsx)(p.a,{variant:"h5",color:"initial",gutterBottom:!0,children:"Pricing Matrix"})}),Object(n.jsxs)(Q.a,{container:!0,spacing:5,children:[Object(n.jsxs)(Q.a,{item:!0,xs:12,md:4,children:[Object(n.jsx)(va.a,{control:Object(n.jsx)(ga.a,{checked:e.includes("Motorcycle"),onClick:function(){return t("Motorcycle")}}),label:"Motorcycle",labelPlacement:"start"}),Object(n.jsx)(g,{mode:"Motorcycle"})]}),Object(n.jsxs)(Q.a,{item:!0,xs:12,md:4,children:[Object(n.jsx)(va.a,{control:Object(n.jsx)(ga.a,{checked:e.includes("Car"),onClick:function(){return t("Car")}}),label:"Car",labelPlacement:"start"}),Object(n.jsx)(g,{mode:"Car"})]}),Object(n.jsxs)(Q.a,{item:!0,xs:12,md:4,children:[Object(n.jsx)(va.a,{control:Object(n.jsx)(ga.a,{checked:e.includes("Mini Van"),onClick:function(){return t("Mini Van")}}),label:"Minivan",labelPlacement:"start"}),Object(n.jsx)(g,{mode:"Mini Van"})]})]})]})},Da=a(282),Ia=a(466),Aa=a(111),Ra=a.n(Aa),Ta=a(279),Pa=a.n(Ta),_a=a(150),La=a.n(_a),Wa={axios_url:null,socket_url:"https://creekside-logistics-backend.herokuapp.com"},Fa=La()(Wa.socket_url);Fa.on("connect",(function(){console.log("I connected...",(new Date).toLocaleTimeString())})),Fa.on("disconnect",(function(){console.log("I disconnected...",(new Date).toLocaleTimeString())})),Fa.on("drivers",(function(e){console.log("drivers available are...",e,(new Date).toLocaleTimeString())}));var Ma="DRIVERS_LOCATION",Ba="SET_ALERT",Ua="REMOVE_ALERT",Va="GET_ALL_NOTIFICATIONS",Ga="NOTIFICATION_ERROR",za="CLEAR_NEW_NOTIFICATIONS",Ha="READ_NOTIFICATION",Qa="READ_ALL_NOTIFICATIONS",Za="LOADING_USER",qa="LOGIN_SUCCESS",Ka="LOGIN_FAIL",Ja="AUTH_ERROR",$a="USER_LOADED",Ya="LOGOUT",Xa="CLEAR_ERROR",en="SET_MODES",tn="NEW_ORDER",an="CLEAR_NEW_ORDER",nn="SET_PATH",rn="CLEAR_PATH",cn="REGISTER_SUCCESS",on="REGISTER_FAIL",sn=function(e,t){switch(t.type){case Ma:return Object(x.a)(Object(x.a)({},e),t.payload);case en:return Object(x.a)(Object(x.a)({},e),{},{modes:t.payload});default:return e}},ln=function(e){var t=Object(r.useReducer)(sn,{drivers:{},markers:[],modes:[]}),a=Object(h.a)(t,2),c=a[0],i=a[1];return Object(n.jsx)(yt.Provider,{value:{drivers:c.drivers,markers:c.markers,modes:c.modes,setDrivers:function(e){var t=Object.keys(e).map((function(t){return Object(x.a)(Object(x.a)({},e[t]),{},{_id:t})}));i({type:Ma,payload:{markers:t,drivers:e}})},setModes:function(e){i({type:en,payload:e})}},children:e.children})},un=[{name:"name",title:"Name"},{name:"phone",title:"Phone"},{name:"email",title:"Email"}],dn=[{columnName:"name"},{columnName:"phone"},{columnName:"email"}],jn=function(e){var t=c.a.useState(!1),a=Object(h.a)(t,2),r=a[0],i=a[1],o=c.a.useState(""),s=Object(h.a)(o,2),l=s[0],u=s[1],d=c.a.useState(""),j=Object(h.a)(d,2),b=j[0],p=j[1],x=c.a.useState(""),v=Object(h.a)(x,2),g=v[0],y=v[1],w=c.a.useState(""),C=Object(h.a)(w,2),k=C[0],S=C[1],N=c.a.useState(""),E=Object(h.a)(N,2),D=E[0],I=E[1],A=c.a.useState(!1),R=Object(h.a)(A,2),T=R[0],P=R[1],_=function(){i(!1)},L=function(){var e=Object(U.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(l&&b&&g&&k&&D)){e.next=13;break}return P(!0),e.prev=2,e.next=5,te.a.post("/api/users",{name:l,email:b,phone:g,password:k});case 5:u(""),y(""),p(""),S(""),I(""),_(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.error(e.t0);case 12:P(!1);case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}();return Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsx)(O.a,{px:1}),Object(n.jsx)(f.a,{color:"secondary",onClick:function(){return i(!0)},children:"Create New"}),Object(n.jsxs)(at.a,{open:r,onClose:_,children:[Object(n.jsx)(nt.a,{children:"New Client"}),Object(n.jsx)(rt.a,{children:Object(n.jsxs)(Q.a,{container:!0,spacing:3,children:[Object(n.jsx)(Q.a,{item:!0,xs:12,children:Object(n.jsx)(m.a,{variant:"outlined",label:"Name",value:l,onChange:function(e){return u(e.target.value)},fullWidth:!0})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:6,children:Object(n.jsx)(m.a,{variant:"outlined",label:"Email",value:b,onChange:function(e){return p(e.target.value)},fullWidth:!0})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:6,children:Object(n.jsx)(m.a,{variant:"outlined",label:"Phone",value:g,onChange:function(e){return y(e.target.value)},fullWidth:!0})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:6,children:Object(n.jsx)(m.a,{variant:"outlined",label:"Password",type:"password",value:k,onChange:function(e){return S(e.target.value)},fullWidth:!0})}),Object(n.jsx)(Q.a,{item:!0,xs:12,md:6,children:Object(n.jsx)(m.a,{variant:"outlined",label:"Secret",value:D,onChange:function(e){return I(e.target.value)},fullWidth:!0})})]})}),Object(n.jsxs)(ot.a,{children:[Object(n.jsx)(f.a,{onClick:L,color:"primary",disabled:T||!(l&&b&&g&&k&&D),children:"Create"}),Object(n.jsx)(f.a,{onClick:_,color:"default",children:"Cancel"})]})]})]})},bn=function(e){c.a.useEffect((function(){I()}),[]);var t=c.a.useState([]),a=Object(h.a)(t,2),r=a[0],i=a[1],o=c.a.useState([]),s=Object(h.a)(o,2),l=s[0],u=s[1],d=c.a.useState([]),j=Object(h.a)(d,2),b=j[0],f=j[1],x=c.a.useState([]),m=Object(h.a)(x,2),v=m[0],g=m[1],y=c.a.useState(0),w=Object(h.a)(y,2),C=w[0],k=w[1],S=c.a.useState(!1),N=Object(h.a)(S,2),E=N[0],D=N[1],I=function(){var e=Object(U.a)(B.a.mark((function e(){var t,a;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(!0),e.prev=1,e.next=4,te.a.get("/api/admin/users");case 4:t=e.sent,a=t.data,i(a.filter((function(e){return!e.valid&&!e.banned}))),u(a.filter((function(e){return e.valid&&!e.banned}))),f(a.filter((function(e){return e.banned}))),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:D(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return c.a.useEffect((function(){switch(C){case 0:g(l);break;case 1:g(r);break;case 2:g(b)}}),[C,E,r,l,b]),Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsxs)(O.a,{display:"flex",flexDirection:"row",mb:3,children:[Object(n.jsx)(p.a,{variant:"h5",color:"initial",gutterBottom:!0,children:"Users"}),Object(n.jsx)(jn,{})]}),Object(n.jsx)($e,{aria:"deliveries tab",tabs:["Active","Pending","Blacklist"],onChange:function(e){return k(e)}}),Object(n.jsx)(et,{rows:v,columns:un,getRowId:function(e){return e._id},columnExtensions:dn,loading:E})]})},hn=a(283);function On(e,t){switch(t.type){case Ba:return t.payload;case Ua:return{msg:"",type:""};default:return e}}var fn=function(e){var t=Object(r.useReducer)(On,{msg:"",type:""}),a=Object(h.a)(t,2),c=a[0],i=a[1],o=function(){i({type:Ua})};return Object(n.jsx)(P.Provider,{value:{alert:c,setAlert:function(e,t){i({type:Ba,payload:{msg:e,type:t}}),setTimeout((function(){o()}),500)}},children:e.children})},pn=function(e){var t=Object(r.useContext)(P).alert,a=Object(r.createRef)();return Object(r.useEffect)((function(){""!==t.msg&&""!==t.type&&a.current.enqueueSnackbar(t.msg,{variant:t.type,preventDuplicate:!0})}),[t,a]),Object(n.jsx)(hn.a,{ref:a,maxSnack:4,children:e.children})},xn=function(e){return Object(n.jsx)(fn,{children:Object(n.jsx)(pn,{children:e.children})})},mn=function(e,t){switch(t.type){case Va:return Object(x.a)(Object(x.a)({},e),{},{notifications:t.payload});case"NEW_NOTIFICATIONS":return Object(x.a)(Object(x.a)({},e),{},{newNotifications:!0});case Qa:case Ha:return Object(x.a)(Object(x.a)({},e),t.payload);case za:return Object(x.a)(Object(x.a)({},e),{},{newNotifications:!1});case tn:return Object(x.a)(Object(x.a)({},e),{},{newOrder:!0});case an:return Object(x.a)(Object(x.a)({},e),{},{newOrder:!1});case"ADS":return Object(x.a)(Object(x.a)({},e),{},{ads:t.payload.ads});default:return e}},vn=function(e){var t=Object(r.useReducer)(mn,{notifications:[],newNotifications:!1,currentNotification:null,ads:[],newOrder:!0}),a=Object(h.a)(t,2),c=a[0],i=a[1],o=function(){var e=Object(U.a)(B.a.mark((function e(){var t;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te.a.get("api/users/ads");case 3:t=e.sent,i({type:"ADS",payload:t.data}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(U.a)(B.a.mark((function e(){var t;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te.a.get("/api/notifications");case 3:t=e.sent,i({type:Va,payload:t.data}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),i({type:Ga,payload:e.t0.response&&(e.t0.response.data&&e.t0.response.data.msg||e.t0.response.statusText)||"Runtime Error"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(U.a)(B.a.mark((function e(t){var a;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te.a.post("/api/notifications/read/".concat(t));case 3:a=e.sent,i({type:Ha,payload:a.data}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(U.a)(B.a.mark((function e(){var t;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te.a.post("/api/notifications/read_all");case 3:t=e.sent,i({type:Qa,payload:t.data}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),i({type:Ga,payload:e.t0.response&&(e.t0.response.data&&e.t0.response.data.msg||e.t0.response.statusText)||"Runtime Error"});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(n.jsx)(tt.Provider,{value:{notifications:c.notifications,currentNotification:c.currentNotification,newNotifications:c.newNotifications,ads:c.ads,newOrder:c.newOrder,readNotification:l,readAllNotifications:u,getNotifications:s,clearNewNotifications:function(){i({type:za})},getAds:o,setNewOrder:function(){return i({type:tn})},clearNewOrder:function(){return i({type:an})}},children:e.children})},gn=function(e,t){switch(t.type){case Za:return Object(x.a)(Object(x.a)({},e),{},{loading:!0,isAuthenticated:!1});case $a:return Object(x.a)(Object(x.a)(Object(x.a)({},e),t.payload),{},{isAuthenticated:!0,loading:!1,userRole:t.payload.user&&t.payload.user.role});case cn:case qa:return localStorage.setItem("token",t.payload.token),Object(x.a)(Object(x.a)(Object(x.a)({},e),t.payload),{},{isAuthenticated:!0,loading:!1});case on:case Ka:case Ja:return localStorage.removeItem("token"),Object(x.a)(Object(x.a)({},e),{},{token:null,isAuthenticated:!1,loading:!1,userRole:null,error:t.payload});case Ya:return localStorage.removeItem("token"),Object(x.a)(Object(x.a)({},e),{},{token:null,isAuthenticated:!1,loading:!1,userRole:null,error:null,user:null});case Xa:return Object(x.a)(Object(x.a)({},e),{},{error:null});case nn:return Object(x.a)(Object(x.a)({},e),{},{path:t.payload});case rn:return Object(x.a)(Object(x.a)({},e),{},{path:null});default:return e}},yn=function(e){e?te.a.defaults.headers.common["x-auth-token"]=e:delete te.a.defaults.headers.common["x-auth-token"]};function wn(e){this.response={data:{msg:e}}}te.a.defaults.baseURL=Wa.axios_url;var Cn=function(e){var t={token:localStorage.getItem("token"),isAuthenticated:!1,loading:!1,userRole:null,error:null,user:null,notifications:null,details:null,path:null},a=Object(r.useReducer)(gn,t),i=Object(h.a)(a,2),o=i[0],s=i[1],l={headers:{"Content-Type":"application/json"}},u=Object(r.useContext)(P).setAlert;c.a.useEffect((function(){o.error&&u(o.error,"error")}),[o.error,u]);var d=function(){var e=Object(U.a)(B.a.mark((function e(){var t;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!localStorage.token){e.next=5;break}yn(localStorage.token),f(),e.next=6;break;case 5:return e.abrupt("return");case 6:return e.prev=6,e.next=9,te.a.get("/api/auth");case 9:t=e.sent,s({type:$a,payload:t.data}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(6),s({type:Ja,payload:e.t0.response&&(e.t0.response.data&&e.t0.response.data.msg||e.t0.response.statusText)||"Runtime Error"}),setTimeout((function(){O()}),500);case 17:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(U.a)(B.a.mark((function e(t){var a;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(),e.prev=1,e.next=4,te.a.post("/api/admin",t,l);case 4:a=e.sent,s({type:cn,payload:a.data}),d(),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),s({type:on,payload:e.t0.response&&(e.t0.response.data&&e.t0.response.data.msg||e.t0.response.statusText)||"Runtime Error"}),setTimeout((function(){O()}),500);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(U.a)(B.a.mark((function e(t){var a;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(),e.prev=1,e.next=4,te.a.post("/api/auth",t,l);case 4:if("admin"===(a=e.sent).data.role){e.next=7;break}throw new wn("Not an admin account");case 7:s({type:qa,payload:a.data}),d(),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),s({type:Ka,payload:e.t0.response&&(e.t0.response.data&&e.t0.response.data.msg||e.t0.response.statusText)||"Runtime Error"}),setTimeout((function(){O()}),500);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),O=function(){s({type:Xa})},f=function(){s({type:Za})},p=function(){s({type:rn})};return Object(n.jsx)(_.Provider,{value:{token:o.token,isAuthenticated:o.isAuthenticated,loading:o.loading,userRole:o.userRole,error:o.error,user:o.user,path:o.path,details:o.details,notifications:o.notifications,loadUser:d,register:j,login:b,logout:function(){s({type:Ya})},clearErrors:O,getPath:function(){var e=o.path;return p(),e},setPath:function(e){s({type:nn,payload:e})},clearPath:p},children:e.children})},kn=function(e,t){switch(t.type){case"CREATE_SOCKET":return Object(x.a)(Object(x.a)({},e),{},{socket:t.payload});default:return e}},Sn=function(e){var t=Object(r.useContext)(tt),a=t.getAds,c=t.getNotifications,i=t.setNewOrder,o=Object(r.useContext)(_).isAuthenticated,s=Object(r.useContext)(yt),l=s.setDrivers,u=s.setModes,d=s.modes,j=Object(r.useReducer)(kn,{socket:null}),b=Object(h.a)(j,2),O=b[0],f=b[1];Object(r.useEffect)((function(){var e=La()(Wa.socket_url);e.on("drivers",(function(e){l(e)})),e.on("modes",u),e.emit("getDrivers"),f({type:"CREATE_SOCKET",payload:e}),e.on("NewDelivery",i)}),[]);return Object(r.useEffect)((function(){if(O.socket){try{te.a.post("/api/notifications/socket",{id:O.socket.id})}catch(e){console.log(e)}O.socket.on("connect",Object(U.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("I connected...",O.socket.id,(new Date).toLocaleTimeString());case 1:case"end":return e.stop()}}),e)})))),O.socket.on("NewNotification",(function(){c()})),O.socket.on("Ads",a)}}),[O.socket,o]),Object(n.jsx)(ya.Provider,{value:{socket:O.socket,switchModes:function(e){var t,a=(d.includes(e)?d.filter((function(t){return t!==e})):[].concat(Object(st.a)(d),[e])).sort((function(e,t){var a=["Motorcycle","Car","Mini Van"];return a.indexOf(e)-a.indexOf(t)}));null===(t=O.socket)||void 0===t||t.emit("switchModes",a)}},children:e.children})},Nn=function(e){return Object(n.jsx)(Cn,{children:Object(n.jsx)(ln,{children:Object(n.jsx)(vn,{children:Object(n.jsx)(Sn,{children:e.children})})})})},En=a(404),Dn=function(e){var t=e.component,a=Object(Rt.a)(e,["component"]),c=Object(r.useContext)(_),i=c.isAuthenticated,o=c.loadUser,s=c.loading,l=Object(r.useState)(!0),u=Object(h.a)(l,2),j=u[0],b=u[1];Object(r.useEffect)((function(){i?b(!1):Object(U.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:b(!1);case 3:case"end":return e.stop()}}),e)})))()}),[]);var f=function(e){return!j&&!s||i?i||s?Object(n.jsx)(t,Object(x.a)({},e)):Object(n.jsx)(d.a,{to:"/login"}):Object(n.jsxs)(O.a,{alignItems:"center",justifyContent:"center",display:"flex",height:"100%",children:[Object(n.jsx)(na.a,{}),Object(n.jsx)(p.a,{variant:"subtitle1",color:"initial",children:"Loading..."})]})};return Object(n.jsx)(d.b,Object(x.a)(Object(x.a)({},a),{},{render:function(e){return Object(n.jsx)(f,Object(x.a)({},e))}}))},In=a(465),An=a(275),Rn=a(276),Tn=a.n(Rn),Pn=a(277),_n=a.n(Pn),Ln=a(278),Wn=a.n(Ln),Fn={title:"",link:"",image:null,expires:null},Mn=function(){var e=Object(r.useState)([]),t=Object(h.a)(e,2),a=t[0],i=t[1],o=Object(r.useState)(Fn),s=Object(h.a)(o,2),l=s[0],u=s[1],d=Object(r.useState)(!1),j=Object(h.a)(d,2),b=j[0],v=j[1],g=Object(r.useState)(!1),y=Object(h.a)(g,2),w=y[0],C=y[1],k=function(){v(!1),u(Fn)},S=function(){var e=Object(U.a)(B.a.mark((function e(){var t;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te.a.get("/api/admin/ads");case 3:t=e.sent,i(t.data.map((function(e){return Object(x.a)({id:e._id},e)}))),console.log(t.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(U.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te.a.post("/api/admin/ads/valid/".concat(t));case 3:n=e.sent,i(a.map((function(e){return e._id!==t?e:Object(x.a)(Object(x.a)({},e),{},{valid:n.data.valid})}))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(U.a)(B.a.mark((function e(t){var a,n,r,c,i,o,s;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C(!0),a=l.title,n=l.link,r=l.image,c=l.expires,a){e.next=6;break}alert("Please input a title"),e.next=26;break;case 6:if(r){e.next=10;break}alert("Please attach an image file"),e.next=26;break;case 10:return e.prev=10,i=new FormData,o="samtwopointoh",i.append("file",r),i.append("upload_preset","jwidlccj"),i.append("cloud_name",o),i.append("folder","ampalAds"),s="https://api.cloudinary.com/v1_1/".concat(o,"/auto/upload"),e.next=20,fetch(s,{method:"POST",body:i}).then((function(e){return e.json()})).then(function(){var e=Object(U.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.a.post("/api/admin/ads",{title:a,link:n,image:t.secure_url,expires:c});case 2:S(),k();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(10),console.log(e.t0),alert("An error occured while uploading this ad");case 26:C(!1);case 27:case"end":return e.stop()}}),e,null,[[10,22]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){S()}),[]),Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsxs)(O.a,{display:"flex",flexDirection:"row",mb:3,children:[Object(n.jsx)(p.a,{variant:"h5",color:"initial",gutterBottom:!0,children:"Advertisement"}),Object(n.jsx)(O.a,{ml:1,children:Object(n.jsx)(f.a,{variant:"text",color:"secondary",onClick:function(){return v(!0)},children:"Create New"})})]}),Object(n.jsxs)(O.a,{children:[Object(n.jsx)(Z.a,{children:Object(n.jsx)(O.a,{height:700,width:1,children:Object(n.jsx)(An.a,{columns:[{field:"image",headerName:"Image",width:300,renderCell:function(e){return Object(n.jsx)("a",{href:e.value,rel:"noreferrer",target:"_blank",children:Object(n.jsx)("img",{width:250,height:250,src:e.value,alt:e.rowIndex})})}},{field:"title",headerName:"Title",width:300},{field:"link",headerName:"Link",width:700,renderCell:function(e){return Object(n.jsx)(In.a,{href:e.value,target:"_blank",children:e.value})}},{field:"dateUploaded",headerName:"Created",width:150,valueFormatter:function(e){return new Date(e.value).toLocaleDateString()}},{field:"expires",headerName:"Expires",width:150,valueFormatter:function(e){return e.value?new Date(e.value).toLocaleDateString():""}},{field:"valid",headerName:"Valid",width:150,renderCell:function(e){return Object(n.jsx)(W.a,{color:e.value?"primary":"default",onClick:function(){return N(e.row.id)},children:e.value?Object(n.jsx)(Tn.a,{}):Object(n.jsx)(_n.a,{})})}}],rows:a,rowHeight:100})})}),Object(n.jsxs)(at.a,{open:b,onClose:!w&&k,"aria-labelledby":"",children:[Object(n.jsx)(nt.a,{children:"Add Advert"}),Object(n.jsx)(rt.a,{children:Object(n.jsx)(O.a,{width:500,children:Object(n.jsxs)(Q.a,{container:!0,spacing:3,display:"flex",direction:"column",children:[Object(n.jsx)(Q.a,{item:!0,children:Object(n.jsx)(m.a,{label:"Title",variant:"standard",value:l.title,onChange:function(e){return u(Object(x.a)(Object(x.a)({},l),{},{title:e.currentTarget.value}))},fullWidth:!0})}),Object(n.jsx)(Q.a,{item:!0,children:Object(n.jsx)(m.a,{label:"Link",variant:"standard",value:l.link,onChange:function(e){return u(Object(x.a)(Object(x.a)({},l),{},{link:e.currentTarget.value}))},fullWidth:!0})}),Object(n.jsx)(Q.a,{item:!0,children:Object(n.jsx)(O.a,{flex:!0,flexDirection:"row",children:Object(n.jsx)(m.a,{label:"File",variant:"standard",disabled:!0,value:l.image?l.image.name:"",onChange:function(e){},fullWidth:!0,InputProps:{endAdornment:Object(n.jsxs)(L.a,{position:"end",children:[Object(n.jsx)("input",{id:"file-input",type:"file",accept:"image/*",style:{display:"none"},onChange:function(e){u(Object(x.a)(Object(x.a)({},l),{},{image:e.target.files[0]}))}}),Object(n.jsx)("label",{htmlFor:"file-input",children:Object(n.jsx)(W.a,{component:"span",color:"primary",children:Object(n.jsx)(Wn.a,{})})})]})}})})}),Object(n.jsx)(Q.a,{item:!0,children:Object(n.jsx)(V.a,{variant:"dialog",inputVariant:"standard",label:"Expires",value:l.expires,minDate:new Date,onChange:function(e){return u(Object(x.a)(Object(x.a)({},l),{},{expires:e}))},fullWidth:!0,views:["month","date","year"],format:"yyyy/MM/dd"})})]})})}),Object(n.jsxs)(ot.a,{children:[Object(n.jsx)(f.a,{onClick:E,disabled:w,color:"primary",children:"Add"}),Object(n.jsx)(f.a,{onClick:k,disabled:w,color:"default",children:"Cancel"})]})]})]})]})},Bn=Object(Da.a)({palette:{primary:{main:Ra.a[800]},secondary:{main:Pa.a.A400},action:{focus:Ra.a[500],selected:Ra.a[700],hover:Ra.a[100]}}});var Un=function(e){var t=Object(d.g)(),a=Object(r.useContext)(tt),c=a.newOrder,i=a.clearNewOrder;return Object(n.jsx)(En.a,{direction:"left",in:c,mountOnEnter:!0,unmountOnExit:!0,children:Object(n.jsx)(O.a,{position:"absolute",bottom:50,right:100,zIndex:"modal",onClick:function(){return t.push("/dashboard/deliveries")},children:Object(n.jsx)(Z.a,{elevation:4,children:Object(n.jsxs)(O.a,{p:2,width:320,alignItems:"center",justifyContent:"space-between",display:"flex",bgcolor:"secondary.main",color:"secondary.contrastText",children:[Object(n.jsx)("img",{src:"https://www.flaticon.com/svg/static/icons/svg/891/891012.svg",height:50,width:50,alt:"Alarm bell"}),Object(n.jsx)(p.a,{variant:"h6",color:"inherit",children:"New order notice"}),Object(n.jsx)(W.a,{onClick:function(e){e.stopPropagation(),i()},children:Object(n.jsx)(b.a,{})})]})})})})},Vn=function(){return Object(n.jsx)(ln,{children:Object(n.jsx)(Ia.a,{theme:Bn,children:Object(n.jsx)(xn,{children:Object(n.jsx)(Nn,{children:Object(n.jsx)(s.a,{utils:l.a,children:Object(n.jsx)(u.a,{children:Object(n.jsxs)(d.d,{children:[Object(n.jsx)(d.b,{exact:!0,path:"/login",component:F}),Object(n.jsx)(d.b,{exact:!0,path:"/register",component:G}),Object(n.jsx)(d.b,{exact:!0,path:"/forgot",component:z}),Object(n.jsx)(d.b,{path:"/dashboard",children:Object(n.jsxs)(ze,{children:[Object(n.jsx)(Dn,{exact:!0,path:"/dashboard/deliveries",component:At}),Object(n.jsx)(Dn,{exact:!0,path:"/dashboard/drivers",component:ja}),Object(n.jsx)(Dn,{exact:!0,path:"/dashboard/users",component:bn}),Object(n.jsx)(d.b,{exact:!0,path:"/dashboard/analytics",component:ne}),Object(n.jsx)(Dn,{exact:!0,path:"/dashboard/pricing",component:Ea}),Object(n.jsx)(Dn,{exact:!0,path:"/dashboard/delivery/:id",component:ia}),Object(n.jsx)(Dn,{exact:!0,path:"/dashboard/driver/:id",component:pa}),Object(n.jsx)(Dn,{exact:!0,path:"/dashboard/ads",component:Mn}),Object(n.jsx)(Un,{})]})}),Object(n.jsx)(d.a,{from:"/",to:"/login"})]})})})})})})})},Gn=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,477)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;a(e),n(e),r(e),c(e),i(e)}))};o.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(Vn,{})}),document.getElementById("root")),Gn()}},[[399,1,2]]]);
//# sourceMappingURL=main.43c6c62b.chunk.js.map