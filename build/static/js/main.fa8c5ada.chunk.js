(this.webpackJsonpadmin=this.webpackJsonpadmin||[]).push([[0],{318:function(e,t,a){},319:function(e,t,a){},349:function(e,t){},376:function(e,t){},380:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a(0),c=a.n(r),i=a(17),o=a.n(i),s=(a(318),a(319),a(40)),l=a(274),d=a(37),u=a(32),j=a(273),b=a.n(j),h=a(8),p=a(446),O=a(101),f=a(65),x=a(11),m=a(285),g=function(e){return Object(n.jsx)("div",{style:{marginTop:8,marginBottom:8,width:"100%"},children:Object(n.jsx)(m.a,Object(x.a)({variant:"outlined",fullWidth:!0},e))})},v=function(){return Object(n.jsx)(p.a,{flexGrow:1,style:{backgroundColor:"black"},height:1})},y=a(133),w=a.n(y),C=a(95),k=a.n(C),S=function(e){return!e||e.length<=0?"Email cannot be empty.":/\S+@\S+\.\S+/.test(e)?"":"Ooops! We need a valid email address."},E=function(e){return!e||e.length<=0?"Password cannot be empty.":""},N=function(e){return!e||e.length<=0?"Phone cannot be empty.":/^0\d{10}$/.test(e.toString().replace(/\s/g,""))||/^\+234\d{10}$/.test(e.toString().replace(/\s/g,""))?"":"Invalid phone format."},D=function(e){if(!e)return"Date of birth cannot be empty.";var t=new Date-new Date(e),a=new Date(t).getFullYear()-1970;return a<6||a>120?"Invalid date of birth":""},I=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],A=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],T=function(e){return[0,1,2,3,4,5,6].map((function(t){var a=e.filter((function(e){return e._id.day===t})),n=a.find((function(e){return"Cancelled"===e._id.status}))||{revenue:0,total:0},r=a.find((function(e){return"Delivered"===e._id.status}))||{revenue:0,total:0};return[{date:I[t],sales:r.total,cancelled:n.total},{date:I[t],sales:r.revenue,cancelled:n.revenue}]})).filter((function(e){return 0!==e[0].sales||0!==e[0].cancelled||0!==e[1].sales||0!==e[1].cancelled}))},R=function(e){return[0,1,2,3,4,5,6,7,8,9,10,11,12].map((function(t){var a=e.filter((function(e){return e._id.month===t})),n=a.find((function(e){return"Cancelled"===e._id.status}))||{revenue:0,total:0},r=a.find((function(e){return"Delivered"===e._id.status}))||{revenue:0,total:0};return[{date:A[t-1],sales:r.total,cancelled:n.total},{date:A[t-1],sales:r.revenue,cancelled:n.revenue}]})).filter((function(e){return 0!==e[0].sales||0!==e[0].cancelled||0!==e[1].sales||0!==e[1].cancelled}))},P=Object(r.createContext)(),_=Object(r.createContext)(),L=a(430),F=a(85),M=function(e){var t=c.a.useContext(P).setAlert,a=c.a.useContext(_),r=a.loading,i=a.login,o=a.isAuthenticated,s=c.a.useState(""),l=Object(h.a)(s,2),u=l[0],j=l[1],b=c.a.useState(""),x=Object(h.a)(b,2),m=x[0],y=x[1],C=c.a.useState(!1),N=Object(h.a)(C,2),D=N[0],I=N[1];return c.a.useEffect((function(){o&&e.history.push("/dashboard/analytics")}),[o]),Object(n.jsxs)(p.a,{width:1,display:"flex",flexDirection:"row",height:1,children:[Object(n.jsxs)(p.a,{width:800,alignItems:"center",justifyContent:"center",height:1,display:"flex",flexDirection:"column",children:[Object(n.jsx)(p.a,{height:.25}),Object(n.jsxs)(p.a,{p:5,m:0,width:.8,children:[Object(n.jsx)(p.a,{display:"flex",justifyContent:"center",children:Object(n.jsx)(f.a,{variant:"h4",color:"primary",alignText:"center",gutterBottom:!0,children:"Sign In"})}),Object(n.jsx)(g,{id:"outlined-basic",value:u,onChange:function(e){return j(e.target.value)},label:"Email",required:!0}),Object(n.jsx)(g,{id:"outlined-basic",value:m,onChange:function(e){return y(e.target.value)},label:"Password",type:D?"text":"password",required:!0,InputProps:{endAdornment:Object(n.jsx)(L.a,{position:"end",children:Object(n.jsx)(F.a,{onClick:function(){return I(!D)},children:D?Object(n.jsx)(w.a,{}):Object(n.jsx)(k.a,{})})})}}),Object(n.jsx)(O.a,{variant:"contained",color:"primary",size:"large",fullWidth:!0,onClick:function(){var e=S(u)||E(m);e?t(e,"error"):(t("Login...","success"),i({email:u,password:m}))},disabled:r,children:r?"Loading...":"Login"}),Object(n.jsx)(p.a,{display:"flex",justifyContent:"flex-end",my:1,children:Object(n.jsx)(f.a,{variant:"body2",color:"primary",align:"right",style:{margin:8,textDecoration:"none"},component:d.b,to:"/forgot",children:"Forgot Password"})})]}),Object(n.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"flex-end",height:.25,children:Object(n.jsx)(f.a,{variant:"body2",color:"textPrimary",align:"right",style:{margin:8,textDecoration:"none"},component:d.b,to:"/register",children:"Create an Account"})})]}),Object(n.jsx)(v,{})]})},B=a(14),W=a.n(B),U=a(21),V=a(447),G=function(e){var t=c.a.useContext(P).setAlert,a=c.a.useContext(_),r=a.register,i=a.error,o=a.isAuthenticated,s=c.a.useState(null),l=Object(h.a)(s,2),u=l[0],j=l[1],b=c.a.useState(""),x=Object(h.a)(b,2),m=x[0],y=x[1],C=c.a.useState(""),I=Object(h.a)(C,2),A=I[0],T=I[1],R=c.a.useState(""),M=Object(h.a)(R,2),B=M[0],G=M[1],z=c.a.useState(""),H=Object(h.a)(z,2),Q=H[0],J=H[1],Z=c.a.useState(""),K=Object(h.a)(Z,2),q=K[0],$=K[1],Y=c.a.useState(!1),X=Object(h.a)(Y,2),ee=X[0],te=X[1];c.a.useEffect((function(){o&&e.history.push("/login")}),[o,e.history]);var ae=function(){var e=Object(U.a)(W.a.mark((function e(){var a,n,c,i,o,s;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=""===m?"Please fill in your full name":"",n=S(A),c=E(B),i=N(Q),o=""===q?"Please fill in the registration secret":"",s=D(u),a||n||c||i||o||s?t([a,n,i,c,o,s].find((function(e){return e})),"error"):r({name:m,email:A,password:B,phone:Q,birthday:u,secret:q});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c.a.useEffect((function(){i&&t(i,"error")}),[i,t]),Object(n.jsxs)(p.a,{width:1,display:"flex",flexDirection:"row",height:1,children:[Object(n.jsxs)(p.a,{width:800,alignItems:"center",justifyContent:"center",height:1,display:"flex",flexDirection:"column",children:[Object(n.jsx)(p.a,{height:.25}),Object(n.jsxs)(p.a,{p:5,m:0,width:.8,children:[Object(n.jsx)(p.a,{display:"flex",justifyContent:"center",children:Object(n.jsx)(f.a,{variant:"h4",color:"primary",alignText:"center",gutterBottom:!0,children:"Create an Account"})}),Object(n.jsx)(g,{id:"outlined-basic",label:"Name",value:m,onChange:function(e){return y(e.target.value)}}),Object(n.jsx)(V.a,{variant:"inline",inputVariant:"outlined",label:"Birthday",value:u,onChange:j,fullWidth:!0,views:["month","date","year"]}),Object(n.jsx)(g,{id:"outlined-basic",label:"Email",value:A,onChange:function(e){return T(e.target.value)}}),Object(n.jsxs)(p.a,{display:"flex",flexDirection:"row",children:[Object(n.jsx)(g,{id:"outlined-basic",label:"Phone",value:Q,onChange:function(e){return J(e.target.value)}}),Object(n.jsx)(g,{id:"outlined-basic",label:"Password",value:B,onChange:function(e){return G(e.target.value)},type:ee?"text":"password",InputProps:{endAdornment:Object(n.jsx)(L.a,{position:"end",children:Object(n.jsx)(F.a,{onClick:function(){return te(!ee)},children:ee?Object(n.jsx)(w.a,{}):Object(n.jsx)(k.a,{})})})}})]}),Object(n.jsx)(g,{id:"outlined-basic",label:"Secret",value:q,onChange:function(e){return $(e.target.value)}}),Object(n.jsx)(O.a,{variant:"contained",color:"primary",size:"large",onClick:ae,fullWidth:!0,children:"Register"})]}),Object(n.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"flex-end",height:.15,children:Object(n.jsx)(f.a,{variant:"body2",color:"textPrimary",align:"right",style:{margin:8,textDecoration:"none"},component:d.b,to:"/login",children:"Back to Login"})})]}),Object(n.jsx)(v,{})]})},z=function(e){return Object(n.jsx)("img",Object(x.a)({alt:"logo",src:"https://images.unsplash.com/photo-1562307534-a03738d2a81a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=500&q=60",height:100,width:100},e))},H=function(){return Object(n.jsxs)(p.a,{width:1,display:"flex",flexDirection:"row",height:1,children:[Object(n.jsxs)(p.a,{width:800,alignItems:"center",justifyContent:"center",height:1,display:"flex",flexDirection:"column",children:[Object(n.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"center",height:.25,children:Object(n.jsx)(z,{})}),Object(n.jsxs)(p.a,{p:5,m:0,width:.8,children:[Object(n.jsx)(p.a,{display:"flex",justifyContent:"center",children:Object(n.jsx)(f.a,{variant:"h4",color:"primary",alignText:"center",gutterBottom:!0,children:"Forgot Password"})}),Object(n.jsx)(g,{id:"outlined-basic",label:"Email"}),Object(n.jsx)(O.a,{variant:"contained",color:"primary",size:"large",fullWidth:!0,children:"Send reset to email"})]}),Object(n.jsx)(p.a,{display:"flex",justifyContent:"center",alignItems:"flex-end",height:.25,children:Object(n.jsx)(f.a,{variant:"body2",color:"textPrimary",align:"right",style:{margin:8,textDecoration:"none"},component:d.b,to:"/login",children:"Back to Login"})})]}),Object(n.jsx)(v,{})]})},Q=a(4),J=a(435),Z=a(84),K=a(76),q=a(24),$=a(113),Y=Object($.a)((function(e){return{avatar:{height:e.spacing(10),width:e.spacing(10)},card:{width:"100%"},primary:{backgroundColor:e.palette.primary.main},primaryText:{color:e.palette.primary.contrastText}}})),X=["#c70039","#111d5e","#f37121","#ffbd69","#334E7E"],ee=function(e){var t=e.lineValues,a=e.barValues,r=e.argument,c=e.data,i=Y();return Array.isArray(c)&&c.length>0?(console.log("Data Values",c),console.log("option 1 "),Object(n.jsx)(Z.a,{className:i.card,children:Object(n.jsx)(p.a,{p:2,children:Object(n.jsxs)(K.c,{data:c,height:200,children:[Object(n.jsx)(q.i,{scheme:X}),Object(n.jsx)(K.a,{})," ",Object(n.jsx)(K.g,{}),Object(n.jsx)(q.f,{})," ",Object(n.jsx)(K.f,{}),Object(n.jsx)(q.a,{}),a&&a.map((function(e,t){return Object(n.jsx)(K.b,{valueField:e,argumentField:r},t)})),t&&t.map((function(e,t){return Object(n.jsx)(K.d,{valueField:e,argumentField:r},t)})),t&&t.map((function(e,t){return Object(n.jsx)(K.e,{valueField:e,argumentField:r},t)}))]})})})):Object(n.jsx)(Z.a,{className:i.card,children:Object(n.jsx)(p.a,{p:2,height:200,display:"flex",alignItems:"center",justifyContent:"center",children:Object(n.jsx)(f.a,{variant:"subtitle1",color:"initial",children:"No data available"})})})},te=a(22),ae=a.n(te),ne=Object($.a)((function(e){return{card:{width:"100%"},primary:{backgroundColor:e.palette.primary.main},primaryText:{color:e.palette.primary.contrastText}}})),re=function(){var e=ne(),t=c.a.useContext(_).loadUser,a=c.a.useState({deliveries:0,cancelled:0}),r=Object(h.a)(a,2),i=r[0],o=r[1],s=c.a.useState({deliveries:0,cancelled:0}),l=Object(h.a)(s,2),d=l[0],u=l[1],j=c.a.useState([]),b=Object(h.a)(j,2),O=b[0],x=b[1],m=c.a.useState([]),g=Object(h.a)(m,2),v=g[0],y=g[1],w=c.a.useState([]),C=Object(h.a)(w,2),k=C[0],S=C[1],E=c.a.useState([]),N=Object(h.a)(E,2),D=N[0],I=N[1],A=c.a.useState([]),P=Object(h.a)(A,2),L=P[0],F=P[1],M=c.a.useState([]),B=Object(h.a)(M,2),V=B[0],G=B[1];return c.a.useEffect((function(){Object(U.a)(W.a.mark((function e(){var a,n,r,c;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(),e.next=4,ae.a.get("/api/admin/performance");case 4:a=e.sent,n=a.data,r=n.day.find((function(e){return"Deliveries"===e._id}))||{total:0,revenue:0},c=n.day.find((function(e){return"Cancelled"===e._id}))||{total:0,revenue:0},o({deliveries:r.total,cancelled:c.total}),u({deliveries:r.revenue,cancelled:c.revenue}),x(T(n.weekly)),y(R(n.monthly)),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))()}),[]),c.a.useEffect((function(){F(O.map((function(e){return e[0]}))),G(O.map((function(e){return e[1]}))),I(v.map((function(e){return e[1]}))),S(v.map((function(e){return e[0]})))}),[O,v]),Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsxs)(p.a,{display:"flex",flexDirection:"row",mb:3,children:[Object(n.jsx)(f.a,{variant:"h5",color:"secondary",gutterBottom:!0,children:"Welcome Back,"}),Object(n.jsx)(p.a,{width:10}),Object(n.jsx)(f.a,{variant:"h5",color:"initial",gutterBottom:!0,children:"Admin"})]}),Object(n.jsxs)(J.a,{container:!0,spacing:5,children:[Object(n.jsx)(J.a,{item:!0,xs:4,children:Object(n.jsx)(f.a,{variant:"subtitle1",color:"inherit",children:"Today"})}),Object(n.jsx)(J.a,{item:!0,xs:4,children:Object(n.jsx)(f.a,{variant:"subtitle1",color:"inherit",children:"This week"})}),Object(n.jsx)(J.a,{item:!0,xs:4,children:Object(n.jsx)(f.a,{variant:"subtitle1",color:"inherit",children:"Monthly"})}),Object(n.jsx)(J.a,{item:!0,xs:12,md:4,children:Object(n.jsx)(Z.a,{className:Object(Q.a)([e.card,e.primary]),children:Object(n.jsxs)(p.a,{p:2,children:[Object(n.jsx)(f.a,{variant:"h6",color:"textPrimary",className:e.primaryText,children:"Sales"}),Object(n.jsx)(p.a,{height:30}),Object(n.jsx)(f.a,{variant:"body1",color:"textSecondary",className:e.primaryText,children:"".concat(i.deliveries," Deliveries")}),Object(n.jsx)(f.a,{variant:"body1",color:"textSecondary",className:e.primaryText,children:"".concat(i.cancelled," Cancelled")})]})})}),Object(n.jsx)(J.a,{item:!0,xs:12,md:4,children:Object(n.jsx)(ee,{data:L,argument:"date",lineValues:["cancelled","sales"]})}),Object(n.jsx)(J.a,{item:!0,xs:12,md:4,children:Object(n.jsx)(ee,{data:k,argument:"date",barValues:["cancelled","sales"]})}),Object(n.jsx)(J.a,{item:!0,xs:12,md:4,children:Object(n.jsx)(Z.a,{className:e.card,children:Object(n.jsxs)(p.a,{p:2,children:[Object(n.jsx)(f.a,{variant:"h6",color:"secondary",children:"Revenue"}),Object(n.jsx)(p.a,{height:30}),Object(n.jsx)(f.a,{variant:"body1",color:"inherit",children:"".concat(d.deliveries," Deliveries")}),Object(n.jsx)(f.a,{variant:"body1",color:"inherit",children:"".concat(d.cancelled," Cancelled")})]})})}),Object(n.jsx)(J.a,{item:!0,xs:12,md:4,children:Object(n.jsx)(ee,{data:V,argument:"date",lineValues:["cancelled","sales"]})}),Object(n.jsx)(J.a,{item:!0,xs:12,md:4,children:Object(n.jsx)(ee,{data:D,argument:"date",barValues:["cancelled","sales"]})})]})]})},ce=a(13),ie=a(16),oe=a(34),se=a(438),le=a(437),de=a(434),ue=a(279),je=a(436),be=a(439),he=a(225),pe=a.n(he),Oe=a(134),fe=a.n(Oe),xe=a(100),me=a.n(xe),ge=a(282),ve=a(386),ye=a(384),we=a(286),Ce=a(105),ke=a.n(Ce),Se=a(218),Ee=a.n(Se),Ne=a(219),De=a.n(Ne),Ie=a(220),Ae=a.n(Ie),Te=a(222),Re=a.n(Te),Pe=a(223),_e=a.n(Pe),Le=a(227),Fe=a.n(Le),Me=a(221),Be=a.n(Me),We=a(226),Ue=a.n(We),Ve=a(224),Ge=a.n(Ve),ze=240,He=[{title:"Analytics",icon:Object(n.jsx)(Ee.a,{}),to:"/dashboard/analytics"},{title:"Deliveries",icon:Object(n.jsx)(De.a,{}),to:"/dashboard/deliveries"},{title:"Drivers",icon:Object(n.jsx)(Ae.a,{}),to:"/dashboard/drivers"},{title:"Users",icon:Object(n.jsx)(Be.a,{}),to:"/dashboard/users"},{title:"Coupons",icon:Object(n.jsx)(Re.a,{}),to:"/dashboard/coupons"},{title:"Pricing",icon:Object(n.jsx)(_e.a,{}),to:"/dashboard/pricing"},{title:"Adverts",icon:Object(n.jsx)(Ge.a,{}),to:"/dashboard/ads"}],Qe=Object($.a)((function(e){return{root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:ze,width:"calc(100% - ".concat(ze,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},hide:{display:"none"},drawer:{width:ze,flexShrink:0,whiteSpace:"nowrap"},drawerOpen:{width:ze,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:Object(ce.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:e.spacing(7)+1},e.breakpoints.up("sm"),{width:e.spacing(9)+1}),toolbar:Object(x.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1)},e.mixins.toolbar),title:Object(ce.a)({flexGrow:1,display:"none"},e.breakpoints.up("sm"),{display:"block"}),search:Object(ce.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(ie.c)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(ie.c)(e.palette.common.white,.25)},marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(1),width:"auto"}),searchIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:Object(ce.a)({padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)"),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("sm"),{width:"40ch","&:focus":{width:"50ch"}}),content:{flexGrow:1,padding:e.spacing(3)}}}));function Je(e){var t,a,r=Qe(),i=Object(oe.a)(),o=c.a.useState(!1),s=Object(h.a)(o,2),l=s[0],u=s[1];return Object(n.jsxs)("div",{className:r.root,children:[Object(n.jsx)(je.a,{}),Object(n.jsx)(le.a,{position:"fixed",className:Object(Q.a)(r.appBar,Object(ce.a)({},r.appBarShift,l)),children:Object(n.jsxs)(de.a,{children:[Object(n.jsx)(F.a,{color:"inherit","aria-label":"open drawer",onClick:function(){u(!0)},edge:"start",className:Object(Q.a)(r.menuButton,Object(ce.a)({},r.hide,l)),children:Object(n.jsx)(pe.a,{})}),Object(n.jsx)(p.a,{display:"flex",flexGrow:1,children:Object(n.jsxs)("div",{className:r.search,children:[Object(n.jsx)("div",{className:r.searchIcon,children:Object(n.jsx)(ke.a,{})}),Object(n.jsx)(we.a,{placeholder:"Search for deliveries, drivers, clients and coupons...",classes:{root:r.inputRoot,input:r.inputInput},inputProps:{"aria-label":"search"}})]})}),Object(n.jsxs)(p.a,{color:"textSecondary",children:[Object(n.jsx)(O.a,{color:"inherit",startIcon:Object(n.jsx)(Ue.a,{}),children:"admin@gmail.com"}),Object(n.jsx)(F.a,{color:"inherit",children:Object(n.jsx)(Fe.a,{})})]})]})}),Object(n.jsxs)(se.a,{variant:"permanent",className:Object(Q.a)(r.drawer,(t={},Object(ce.a)(t,r.drawerOpen,l),Object(ce.a)(t,r.drawerClose,!l),t)),classes:{paper:Object(Q.a)((a={},Object(ce.a)(a,r.drawerOpen,l),Object(ce.a)(a,r.drawerClose,!l),a))},children:[Object(n.jsx)("div",{className:r.toolbar,children:Object(n.jsx)(F.a,{onClick:function(){u(!1)},children:"rtl"===i.direction?Object(n.jsx)(me.a,{}):Object(n.jsx)(fe.a,{})})}),Object(n.jsx)(be.a,{}),Object(n.jsx)(ue.a,{children:He.map((function(e,t){return Object(n.jsxs)(ge.a,{button:!0,component:d.b,to:e.to,children:[Object(n.jsx)(ve.a,{children:e.icon}),Object(n.jsx)(ye.a,{primary:e.title})]},t)}))})]}),Object(n.jsxs)("main",{className:r.content,children:[Object(n.jsx)("div",{className:r.toolbar}),e.children]})]})}for(var Ze=a(10),Ke=a(448),qe=a(440),$e=Object($.a)((function(e){return{root:{flexGrow:1},padding:{padding:e.spacing(3)}}})),Ye=Object(Ze.a)((function(e){return{root:{borderBottom:"1px solid #e8e8e8"},indicator:{backgroundColor:e.palette.action.selected}}}))(Ke.a),Xe=Object(Ze.a)((function(e){return{root:{textTransform:"none",minWidth:72,fontWeight:e.typography.fontWeightRegular,marginRight:e.spacing(4),fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(","),"&:hover":{color:e.palette.action.hover,opacity:1},"&$selected":{color:e.palette.action.selected,fontWeight:e.typography.fontWeightMedium},"&:focus":{color:e.palette.action.focus}},selected:{}}}))((function(e){return Object(n.jsx)(qe.a,Object(x.a)({disableRipple:!0},e))})),et=function(e){var t=e.aria,a=e.tabs,r=e.onChange,i=$e(),o=c.a.useState(0),s=Object(h.a)(o,2),l=s[0],d=s[1];c.a.useEffect((function(){r(l)}),[l,r]);return Object(n.jsx)("div",{className:i.root,children:Object(n.jsxs)("div",{className:i.demo1,children:[Object(n.jsx)(Ye,{value:l,onChange:function(e,t){d(t)},"aria-label":t,children:a.map((function(e,t){return Object(n.jsx)(Xe,{label:e},t)}))}),Object(n.jsx)(f.a,{className:i.padding})]})})},tt=a(53),at=a(15),nt=function(e){var t=e.rows,a=e.columns,r=e.formatters,i=e.onClick,o=e.getRowId,s=e.columnExtensions,l=e.loading,d=e.footer,u=c.a.useState(),j=Object(h.a)(u,2),b=j[0],p=j[1];return c.a.useEffect((function(){b&&i&&i(b)}),[b,i]),Object(n.jsxs)(Z.a,{children:[Object(n.jsxs)(tt.a,{rows:t,columns:a,getRowId:o,children:[Object(n.jsx)(tt.g,{columnExtensions:s}),Object(n.jsx)(tt.d,{}),Object(n.jsx)(at.k,{selection:b,onSelectionChange:function(e){return p([e.length&&e[e.length-1]])}}),l&&Object(n.jsx)(at.F,{loading:!0,getRows:function(){return t&&t.length||100}}),Object(n.jsx)(tt.f,{selectByRowClick:!0,highlightRow:!0,showSelectionColumn:!1}),r]}),d]})},rt=Object(r.createContext)(),ct=[],it=0;it<100;it++)ct.push({id:it,dateCreated:(new Date).toISOString(),client:"Samuel Seibidor",pickUp:"10, Wogu Street D/Line, Port Harcourt",dropOff:"Creekside Logistics, Port Harcourt",distance:5,mode:"Motorcycle"});var ot=[{name:"dateCreated",title:"Date Created"},{name:"client",title:"Client"},{name:"pickUp",title:"Pick-up"},{name:"dropOff",title:"Drop-off"},{name:"distance",title:"Distance (km)"},{name:"mode",title:"Mode"}],st=[{columnName:"distance",width:120,align:"center"}],lt=function(e){var t=e.value;return new Date(t).toLocaleDateString()},dt=function(e){return Object(n.jsx)(at.b,Object(x.a)({formatterComponent:lt},e))},ut=function(e){var t=c.a.useState([]),a=Object(h.a)(t,2),r=a[0],i=a[1],o=c.a.useState([]),s=Object(h.a)(o,2),l=s[0],d=s[1],u=c.a.useState([]),j=Object(h.a)(u,2),b=j[0],O=j[1],x=c.a.useState([]),m=Object(h.a)(x,2),g=m[0],v=m[1],y=c.a.useState([]),w=Object(h.a)(y,2),C=w[0],k=w[1],S=c.a.useState(0),E=Object(h.a)(S,2),N=E[0],D=E[1],I=c.a.useState(!1),A=Object(h.a)(I,2),T=A[0],R=A[1],P=c.a.useContext(rt),_=P.newOrder,L=P.clearNewOrder;c.a.useEffect((function(){F(),L()}),[]),c.a.useEffect((function(){_&&(F(),setTimeout(L,1e4))}),[_,L]);var F=function(){var e=Object(U.a)(W.a.mark((function e(){var t,a;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R(!0),e.prev=1,e.next=4,ae.a.get("/api/admin/deliveries");case 4:t=e.sent,a=t.data,i(a.filter((function(e){return"Pending"===e.status}))),d(a.filter((function(e){return"Processing"===e.status}))),v(a.filter((function(e){return"Cancelled"===e.status}))),O(a.filter((function(e){return"Delivered"===e.status}))),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:R(!1);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}(),M=function(e){return e.map((function(e){var t=e.dateCreated,a=e.client,n=e.from,r=e.to,c=e.distance,i=e.mode,o=e._id,s=n&&n.address,l=r&&r.address;return{dateCreated:t,client:(a||{name:""}).name,pickUp:s,dropOff:l,distance:c,mode:i,_id:o}}))};return c.a.useEffect((function(){switch(N){case 0:k(M(r));break;case 1:k(M(l));break;case 2:k(M(b));break;case 3:k(M(g))}}),[N,T,r,l,b,g]),Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsx)(p.a,{display:"flex",flexDirection:"row",mb:3,children:Object(n.jsx)(f.a,{variant:"h5",color:"initial",gutterBottom:!0,children:"Deliveries"})}),Object(n.jsx)(et,{aria:"deliveries tab",tabs:["Pending","Processing","Delivered","Cancelled"],onChange:function(e){return D(e)}}),Object(n.jsx)(nt,{rows:C,columns:ot,getRowId:function(e){return e._id},columnExtensions:st,formatters:[Object(n.jsx)(dt,{for:["dateCreated"]})],onClick:function(t){e.history.push("/dashboard/delivery/".concat(t))},loading:T})]})},jt=a(7),bt=a(263),ht=a.n(bt),pt=a(264),Ot=a.n(pt),ft=a(265),xt=a.n(ft),mt=a(452),gt=a(97),vt=a(232),yt=a.n(vt),wt=a(146),Ct=a(167),kt=a(453),St=a(173),Et={pulse:{animation:"x 1s infinite ease-in-out",animationName:wt.a.keyframes(yt.a,"pulse")}},Nt=Object(Ze.a)((function(e){return{arrow:{color:e.palette.common.black},tooltip:{backgroundColor:e.palette.common.black,color:e.palette.primary.contrastText,boxShadow:e.shadows[1],fontSize:11}}}))(St.a),Dt=function(e){var t=e.lat,a=e.lng,r=e.src,i=e.name,o=e.action,s=e.to,l=e.id,u=e.animate,j=e.onClick,b=u?Et.pulse:{};return Object(n.jsx)(c.a.Fragment,{children:Object(n.jsx)("div",{lat:t,lng:a,children:Object(n.jsx)(Ct.a,{children:Object(n.jsx)(Nt,{interactive:!0,arrow:!0,placement:"top-end",title:Object(n.jsxs)(p.a,{display:"flex",p:1,alignContent:"center",children:[Object(n.jsx)(p.a,{pr:2,children:i}),Object(n.jsx)(f.a,{variant:"body2",color:"secondary",style:{textDecoration:"none"},component:d.b,onClick:j,to:s,children:o})]}),children:Object(n.jsx)("div",{style:b,children:Object(n.jsx)(kt.a,{src:r,"aria-describedby":l})})})})})})},It=Object(r.createContext)(),At=(a(347),a(350),function(e){try{return new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).formatToParts(e).map((function(e){var t=e.type,a=e.value;switch(t){case"currency":return"\u20a6".concat(a," ");default:return a}})).reduce((function(e,t){return e+t})).replace("NGN ","").replace("\u20a6\u20a6","\u20a6")}catch(t){return"\u20a6".concat(e," ")}}),Tt=a(261),Rt=a.n(Tt),Pt=a(262),_t=a.n(Pt),Lt={bounce:{animation:"x 3s infinite ease-in-out",animationName:wt.a.keyframes(Rt.a,"bounce")}},Ft=Object(Ze.a)((function(e){return{arrow:{color:e.palette.common.black},tooltip:{backgroundColor:e.palette.common.black,color:e.palette.primary.contrastText,boxShadow:e.shadows[1],fontSize:11}}}))(St.a),Mt=function(e){var t=e.lat,a=e.lng,r=e.color,i=e.address,o=e.id,s=e.animate?Lt.bounce:{},l=c.a.useState(!1),d=Object(h.a)(l,2),u=d[0],j=d[1];return Object(n.jsx)(c.a.Fragment,{children:Object(n.jsx)("div",{lat:t,lng:a,children:Object(n.jsx)(Ct.a,{children:Object(n.jsx)(Ft,{arrow:!0,placement:"top-end",title:Object(n.jsx)(p.a,{display:"flex",p:1,alignContent:"center",children:Object(n.jsx)(p.a,{pr:2,children:i})}),children:Object(n.jsx)("div",{style:u?{}:s,onMouseOver:function(){return j(!0)},onMouseEnter:function(){return j(!0)},onMouseLeave:function(){return j(!1)},children:Object(n.jsx)(p.a,{color:r||"secondary",children:Object(n.jsx)(_t.a,{fontSize:"large",color:"inherit","aria-describedby":i&&o})})})})})})})},Bt=a(383),Wt=a(216),Ut=a(86),Vt=a(431),Gt=a(432),zt=a(433),Ht=a(442),Qt=Object($.a)((function(e){return{distance:{color:e.palette.text.primary,position:"relative",bottom:"60vh",zIndex:100,padding:e.spacing(2)}}})),Jt=function(){var e=c.a.useContext(It).markers,t=Qt(),a=Object(u.h)().id,r=function(e){var t=e.mode,a=Object(jt.a)(e,["mode"]);switch(t){case"Motorcycle":return Object(n.jsx)(ht.a,Object(x.a)({},a));case"Car":return Object(n.jsx)(Ot.a,Object(x.a)({},a));case"Minivan":return Object(n.jsx)(xt.a,Object(x.a)({},a));default:return Object(n.jsx)(c.a.Fragment,{})}},i=c.a.useState(0),o=Object(h.a)(i,2),s=(o[0],o[1],c.a.useState(!1)),l=Object(h.a)(s,2),j=l[0],b=l[1],m=c.a.useState(!1),g=Object(h.a)(m,2),v=g[0],y=g[1],w=c.a.useState(null),C=Object(h.a)(w,2),k=C[0],S=C[1],E=c.a.useState({client:null,dateCreated:null,distance:null,from:null,mode:null,price:null,status:null,to:null,track:[],driver:null,driverComment:[]}),N=Object(h.a)(E,2),D=N[0],I=N[1],A=D.client,T=(D.dateCreated,D.distance),R=D.from,P=D.mode,_=D.price,L=D.status,F=D.to,M=D.track,B=D.driver;D.driverComment;console.log("Delivery..",D);var V=c.a.useState(null),G=Object(h.a)(V,2),z=G[0],H=G[1],Q=function(){H(null)},J=function(){return S(null)},Z=function(){var e=Object(U.a)(W.a.mark((function e(t){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.a.post("/api/admin/delivery/status",{status:t,id:a});case 3:I(Object(x.a)(Object(x.a)({},D),{},{status:t})),J(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();c.a.useEffect((function(){K()}),[]);var K=function(){var e=Object(U.a)(W.a.mark((function e(){var t;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.prev=1,e.next=4,ae.a.get("/api/delivery/".concat(a));case 4:t=e.sent,I(t.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:b(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=Object(U.a)(W.a.mark((function e(t){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Driver...",t),e.next=4,ae.a.post("/api/admin/delivery/assign",{id:a,driverID:t._id,reassign:D.driver});case 4:I(Object(x.a)(Object(x.a)({},D),{},{status:"Processing",driver:t})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return j?Object(n.jsxs)(p.a,{alignItems:"center",justifyContent:"center",display:"flex",height:"100%",children:[Object(n.jsx)(Bt.a,{}),Object(n.jsx)(f.a,{variant:"subtitle1",color:"initial",children:"Loading..."})]}):Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsx)(p.a,{display:"flex",flexDirection:"row",mb:3,children:Object(n.jsx)(f.a,{variant:"h5",color:"initial",gutterBottom:!0,children:"Delivery Info"})}),Object(n.jsxs)(p.a,{display:"flex",flexDirection:"row",children:[Object(n.jsx)(f.a,{variant:"subtitle1",color:"initial",children:"ID: "+a}),Object(n.jsx)(p.a,{width:100}),Object(n.jsx)(f.a,{variant:"subtitle1",color:"initial",children:"Mode:"}),Object(n.jsx)(p.a,{width:10}),P&&Object(n.jsx)(r,{color:"primary",mode:P}),Object(n.jsx)(p.a,{width:100}),Object(n.jsx)(f.a,{variant:"subtitle1",color:"initial",children:_&&"Price:  "+At(_)}),Object(n.jsx)(p.a,{width:100}),L&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(f.a,{variant:"subtitle1",color:"initial",children:"Status"}),Object(n.jsx)(p.a,{width:10}),Object(n.jsx)(mt.a,{label:L,color:"secondary",onClick:function(e){H(e.currentTarget)}}),Object(n.jsx)(Wt.a,{id:"status-change",anchorEl:z,keepMounted:!0,open:Boolean(z),onClose:Q,children:["Pending","Processing","Delivered","Cancelled"].map((function(e){return L!==e?Object(n.jsx)(Ut.a,{onClick:function(){Q(),S(e)},children:e},e):null}))})]})]}),Object(n.jsxs)(p.a,{height:"60vh",my:3,children:[Object(n.jsxs)(gt.a,{bootstrapURLKeys:{key:"AIzaSyAVa67y3wWEBxeAR5Q0p4PZtVknjarOlhQ"},defaultCenter:{lat:4.8156,lng:7.0498},defaultZoom:15,children:[["Pending","Processing"].includes(L)&&e.map((function(e,t){return Object(n.jsx)(Dt,{lat:e.latitude,lng:e.longitude,src:e.photoUrl,name:e.name,action:B?"Re-assign":"Assign",id:e._id,animate:!0,onClick:function(){console.log(e),q(e)}},t)})),F&&F.address&&Object(n.jsx)(Mt,{lat:F.latitude,lng:F.longitude,color:"secondary.main",address:F.address,id:"to",animate:!0}),R&&R.address&&Object(n.jsx)(Mt,{lat:R.latitude,lng:R.longitude,color:"primary.main",address:R.address,id:"from",animate:!0})]}),Object(n.jsx)(p.a,{children:Object(n.jsx)(f.a,{variant:"h4",color:"textSecondary",className:t.distance,children:T})})]}),Object(n.jsxs)(p.a,{display:"flex",flexDirection:"row",alignItems:"center",children:[Object(n.jsx)(O.a,{variant:"contained",color:"secondary",onClick:function(){return y(!0)},children:"Track Order"}),Object(n.jsx)(p.a,{display:"flex",flexGrow:1}),A&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(f.a,{variant:"subtitle2",children:" Client: "}),Object(n.jsx)(p.a,{width:5}),Object(n.jsx)(f.a,{variant:"subtitle2",component:d.b,to:"/dashboard/client/".concat(A._id),color:"textPrimary",children:A.name})]}),B&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(p.a,{width:15}),Object(n.jsx)(f.a,{variant:"subtitle2",children:" Driver: "}),Object(n.jsx)(p.a,{width:5}),Object(n.jsx)(f.a,{variant:"subtitle2",component:d.b,to:"/dashboard/driver/".concat(B._id),color:"textPrimary",children:B.name})]}),Object(n.jsxs)(Vt.a,{open:k,onClose:J,children:[Object(n.jsx)(Gt.a,{children:Object(n.jsx)(f.a,{variant:"subtitle1",color:"initial",children:"Are you sure you want to set this delivery to ".concat(k,".")})}),Object(n.jsxs)(zt.a,{children:[Object(n.jsx)(O.a,{variant:"text",color:"primary",onClick:function(){return Z(k)},children:"Yes"}),Object(n.jsx)(O.a,{variant:"text",color:"default",onClick:J,children:"No"})]})]}),Object(n.jsxs)(Vt.a,{maxWidth:"sm",fullWidth:!0,open:v,onClose:function(){return y(!1)},children:[Object(n.jsx)(Ht.a,{children:"Activity tracking"}),Object(n.jsx)(Gt.a,{children:Object(n.jsx)(ue.a,{children:M.map((function(e,t){return Object(n.jsx)(ge.a,{children:Object(n.jsx)(ye.a,{primary:Object(n.jsx)(f.a,{variant:"subtitle1",color:"initial",children:e.action}),secondary:new Date(e.timestamp).toUTCString()})},t)}))})})]})]})]})},Zt=[{name:"photoUrl",title:" "},{name:"name",title:"Name"},{name:"staffID",title:"Staff ID"},{name:"phone",title:"Phone"},{name:"email",title:"Email"}],Kt=[{columnName:"photoUrl",width:100,align:"center"},{columnName:"name"},{columnName:"staffID"},{columnName:"phone"},{columnName:"email"}],qt=function(e){var t=e.value;return Object(n.jsx)(kt.a,{alt:"Driver image",src:t})},$t=function(e){return Object(n.jsx)(at.b,Object(x.a)({formatterComponent:qt},e))},Yt=function(e){c.a.useEffect((function(){A()}),[]);var t=c.a.useState([]),a=Object(h.a)(t,2),r=a[0],i=a[1],o=c.a.useState([]),s=Object(h.a)(o,2),l=s[0],d=s[1],u=c.a.useState([]),j=Object(h.a)(u,2),b=j[0],O=j[1],x=c.a.useState([]),m=Object(h.a)(x,2),g=m[0],v=m[1],y=c.a.useState(0),w=Object(h.a)(y,2),C=w[0],k=w[1],S=c.a.useState(!1),E=Object(h.a)(S,2),N=E[0],D=E[1],I=c.a.useContext(It).markers,A=function(){var e=Object(U.a)(W.a.mark((function e(){var t,a;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(!0),e.prev=1,e.next=4,ae.a.get("/api/admin/drivers");case 4:t=e.sent,a=t.data,i(a.filter((function(e){return!e.valid&&!e.banned}))),d(a.filter((function(e){return e.valid&&!e.banned}))),O(a.filter((function(e){return e.banned}))),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:D(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();c.a.useEffect((function(){switch(C){case 0:v(l);break;case 1:v(r);break;case 2:v(b)}}),[C,N,r,l,b]);var T=Object(n.jsx)(nt,{rows:g,columns:Zt,getRowId:function(e){return e._id},formatters:[Object(n.jsx)($t,{for:["photoUrl"]})],columnExtensions:Kt,loading:N,onClick:function(t){e.history.push("/dashboard/driver/".concat(t))}}),R=Object(n.jsx)(p.a,{width:"100%",style:{height:500},children:Object(n.jsx)(gt.a,{bootstrapURLKeys:{key:"AIzaSyAVa67y3wWEBxeAR5Q0p4PZtVknjarOlhQ"},defaultCenter:{lat:4.8156,lng:7.0498},defaultZoom:15,children:I.map((function(e){return Object(n.jsx)(Dt,{lat:e.latitude,lng:e.longitude,src:e.photoUrl,name:e.name,id:e._id,action:"View",to:"/dashboard/driver/".concat(e._id),animate:!0})}))})});return Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsx)(p.a,{display:"flex",flexDirection:"row",mb:3,children:Object(n.jsx)(f.a,{variant:"h5",color:"initial",gutterBottom:!0,children:"Drivers"})}),Object(n.jsx)(et,{aria:"deliveries tab",tabs:["Active","Pending","Blacklist","Map"],onChange:function(e){return k(e)}}),3===C?R:T]})},Xt=a(443),ea=a(266),ta=a.n(ea),aa=Object($.a)((function(e){var t;return{avatar:(t={marginRight:e.spacing(1)},Object(ce.a)(t,e.breakpoints.down("md"),{height:e.spacing(10),width:e.spacing(10)}),Object(ce.a)(t,e.breakpoints.up("md"),{height:e.spacing(7),width:e.spacing(7)}),Object(ce.a)(t,e.breakpoints.up("lg"),{height:e.spacing(10),width:e.spacing(10)}),t),card:{width:"100%"},primary:{backgroundColor:e.palette.primary.main},primaryText:{color:e.palette.primary.contrastText}}})),na=function(e){var t=aa(),a=Object(u.h)().id,i=Object(r.useContext)(It).drivers,o=c.a.useState(null),s=Object(h.a)(o,2),l=s[0],d=s[1],j=c.a.useState(!1),b=Object(h.a)(j,2),m=b[0],g=b[1],v=c.a.useState(!1),y=Object(h.a)(v,2),w=y[0],C=y[1],k=c.a.useState(0),S=Object(h.a)(k,2),E=S[0],N=S[1],D=c.a.useState([]),I=Object(h.a)(D,2),A=I[0],P=I[1],_=c.a.useState([]),L=Object(h.a)(_,2),F=L[0],M=L[1],B=c.a.useState([]),V=Object(h.a)(B,2),G=V[0],z=V[1],H=c.a.useState([]),K=Object(h.a)(H,2),q=K[0],$=K[1],Y=function(e){var t=e.value;return new Date(t).toLocaleDateString()},X=function(e){return Object(n.jsx)(at.b,Object(x.a)({formatterComponent:Y},e))},te=c.a.useState([]),ne=Object(h.a)(te,2),re=ne[0],ce=ne[1],ie=c.a.useState([]),oe=Object(h.a)(ie,2),se=oe[0],le=oe[1],de=c.a.useState([]),je=Object(h.a)(de,2),he=je[0],pe=je[1],Oe=c.a.useState([]),fe=Object(h.a)(Oe,2),xe=fe[0],me=fe[1],ve=c.a.useState({}),we=Object(h.a)(ve,2),Ce=we[0],ke=we[1],Se=c.a.useState(!0),Ee=Object(h.a)(Se,2),Ne=Ee[0],De=Ee[1],Ie=c.a.useState({delivered:0,cancelled:0}),Ae=Object(h.a)(Ie,2),Te=Ae[0],Re=Ae[1],Pe=function(){var e=Object(U.a)(W.a.mark((function e(){var t,n,r,c;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return De(!0),e.prev=1,e.next=4,ae.a.get("/api/admin/driver/".concat(a));case 4:t=e.sent,ke(t.data),t.data.performance.deliveries.weekly&&ce(T(t.data.performance.deliveries.weekly)),t.data.performance.deliveries.monthly&&le(R(t.data.performance.deliveries.monthly)),n=t.data.performance,r=n.day.find((function(e){return"Deliveries"===e._id}))||{total:0,revenue:0},c=n.day.find((function(e){return"Cancelled"===e._id}))||{total:0,revenue:0},Re({delivered:r.total,cancelled:c.total}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0);case 17:De(!1);case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(){return e.apply(this,arguments)}}();c.a.useEffect((function(){me(re.map((function(e){return e[0]}))),pe(se.map((function(e){return e[0]})))}),[re,se]),c.a.useEffect((function(){Pe(),_e()}),[]),c.a.useEffect((function(){d(i[a])}),[i,a]);var _e=function(){var e=Object(U.a)(W.a.mark((function e(){var t,n;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(!0),e.prev=1,e.next=4,ae.a.get("/api/admin/driver/deliveries/".concat(a));case 4:t=e.sent,n=t.data,P(n.filter((function(e){return"Processing"===e.status}))),z(n.filter((function(e){return"Cancelled"===e.status}))),M(n.filter((function(e){return"Delivered"===e.status}))),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:C(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}(),Le=function(e){return e.map((function(e){var t=e.dateCreated,a=e.client,n=e.from,r=e.to,c=e.distance,i=e.mode,o=e._id,s=n&&n.address,l=r&&r.address;return{dateCreated:t,client:(a||{name:""}).name,pickUp:s,dropOff:l,distance:c,mode:i,_id:o}}))};return c.a.useEffect((function(){switch(E){case 0:$(Le(A));break;case 1:$(Le(F));break;case 2:$(Le(G))}}),[E,Ne,A,F,G]),Ne?Object(n.jsx)(p.a,{alignItems:"center",justifyContent:"center",display:"flex",height:"100%",children:Object(n.jsx)(Bt.a,{})}):Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsx)(p.a,{display:"flex",flexDirection:"row",mb:3,children:Object(n.jsx)(f.a,{variant:"h5",color:"initial",gutterBottom:!0,children:"Driver"})}),Object(n.jsxs)(J.a,{container:!0,spacing:3,children:[Object(n.jsxs)(J.a,{item:!0,xs:6,md:3,children:[Object(n.jsxs)(Z.a,{style:{maxWidth:300},children:[Object(n.jsx)(p.a,{p:2,children:Object(n.jsxs)(J.a,{container:!0,spacing:2,justify:"flex-start",alignItems:"center",children:[Object(n.jsx)(J.a,{item:!0,xs:4,children:Object(n.jsx)(kt.a,{className:t.avatar,src:Ce.photoUrl})}),Object(n.jsxs)(J.a,{item:!0,xs:8,justify:"flex-start",children:[Object(n.jsx)(f.a,{variant:"h6",color:"secondary",noWrap:!0,children:Ce.name}),Object(n.jsx)(f.a,{variant:"body2",color:"initial",noWrap:!0,children:"Staff ID: ".concat(Ce.staffID)})]})]})}),Object(n.jsx)(be.a,{}),Object(n.jsxs)(ue.a,{children:[Object(n.jsxs)(ge.a,{children:[Object(n.jsx)(ye.a,{primary:"Email",secondary:Ce.email}),Object(n.jsx)(Xt.a,{children:Object(n.jsx)(ta.a,{})})]}),Object(n.jsxs)(ge.a,{children:[Object(n.jsx)(ye.a,{primary:"Phone",secondary:Ce.phone}),Object(n.jsx)(Xt.a,{children:Object(n.jsx)(O.a,{variant:"text",color:"secondary",onClick:function(){return g(!0)},children:"View Orders"})})]})]})]}),Object(n.jsxs)(p.a,{mt:5,children:[Object(n.jsx)(f.a,{variant:"body2",color:"initial",gutterBottom:!0,children:"Today"}),Object(n.jsx)(Z.a,{className:Object(Q.a)([t.card,t.primary]),children:Object(n.jsxs)(p.a,{p:2,children:[Object(n.jsx)(f.a,{variant:"h6",color:"textPrimary",className:t.primaryText,children:"Sales"}),Object(n.jsx)(p.a,{height:30}),Object(n.jsxs)(f.a,{variant:"body1",color:"textSecondary",className:t.primaryText,children:[Te.delivered," Delivered"]}),Object(n.jsxs)(f.a,{variant:"body1",color:"textSecondary",className:t.primaryText,children:[Te.cancelled," Cancelled"]})]})})]})]}),Object(n.jsxs)(J.a,{item:!0,xs:6,md:4,children:[Object(n.jsx)(f.a,{variant:"body2",color:"initial",gutterBottom:!0,children:"This week"}),Object(n.jsx)(ee,{data:xe,argument:"date",lineValues:["sales","cancelled"]}),Object(n.jsxs)(p.a,{mt:5,children:[Object(n.jsx)(f.a,{variant:"body2",color:"initial",gutterBottom:!0,children:"Monthly"}),Object(n.jsx)(ee,{data:he,argument:"date",barValues:["sales","cancelled"]})]})]}),Object(n.jsx)(J.a,{item:!0,xs:12,md:5,children:Object(n.jsx)(p.a,{height:550,width:1,children:Object(n.jsx)(gt.a,{bootstrapURLKeys:{key:"AIzaSyAVa67y3wWEBxeAR5Q0p4PZtVknjarOlhQ"},defaultCenter:{lat:4.8156,lng:7.0498},center:{lat:l?l.latitude:4.8156,lng:l?l.longitude:7.0498},defaultZoom:15,children:l&&Object(n.jsx)(Dt,{lat:l.latitude,lng:l.longitude,src:l.photoUrl,name:l.name,id:a,animate:!0})})})})]}),Object(n.jsxs)(Vt.a,{maxWidth:"lg",open:m,onClose:function(){return g(!1)},children:[Object(n.jsx)(Ht.a,{children:"Orders"}),Object(n.jsx)(Gt.a,{children:Object(n.jsxs)(p.a,{children:[Object(n.jsx)(et,{aria:"deliveries tab",tabs:["Processing","Delivered","Cancelled"],onChange:function(e){return N(e)}}),Object(n.jsx)(nt,{rows:q,columns:[{name:"dateCreated",title:"Date Created"},{name:"client",title:"Client"},{name:"pickUp",title:"Pick-up"},{name:"dropOff",title:"Drop-off"},{name:"distance",title:"Distance (km)"},{name:"mode",title:"Mode"}],getRowId:function(e){return e._id},columnExtensions:[{columnName:"distance",width:120,align:"center"}],formatters:[Object(n.jsx)(X,{for:["dateCreated"]})],onClick:function(t){e.history.push("/dashboard/delivery/".concat(t))},loading:w})]})})]})]})},ra=a(267),ca=a.n(ra),ia=a(387),oa=a(388),sa=Object(r.createContext)(),la=a(25),da=function(e){return e.id},ua=function(e){var t=e.onClick,a=Object(jt.a)(e,["onClick"]);return Object(n.jsx)(tt.b.Cell,Object(x.a)(Object(x.a)({},a),{},{tabIndex:0,onFocus:t}))},ja=function(e){var t=e.columns,a=e.rowsStart,i=e.columnExtensions,o=e.onClose,s=e.open,l=e.mode,d=e.setMatrix,u=Object(r.useState)([]),j=Object(h.a)(u,2),b=j[0],f=j[1],m=Object(r.useState)([]),g=Object(h.a)(m,2),v=g[0],y=g[1],w=Object(r.useState)(!1),C=Object(h.a)(w,2),k=C[0],S=C[1],E=Object(r.useContext)(P).setAlert;c.a.useEffect((function(){Array.isArray(a)&&s?f(a.map((function(e,t){return Object(x.a)(Object(x.a)({},e),{},{id:e.id||t})}))):f([])}),[s]);var N=function(){var e=Object(U.a)(W.a.mark((function e(){var t;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(!0),e.prev=1,t=b.map((function(e){var t=Number(e.price),a=Number(e.distance);if(isNaN(a)||isNaN(t))throw Error("Invalid Price or Distance value");return{id:e.id,price:t,distance:a}})).sort((function(e,t){return e.distance-t.distance})),e.next=5,ae.a.post("/api/admin/price",{priceList:t,mode:l});case 5:d(t),o(),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),E("Please review Price List","error");case 13:S(!1);case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),D=function(e){var a,n=e.added,r=e.changed,c=e.deleted;if(n){var i=b.length>0?Math.max(b[b.length-1].id,b[0].id)+1:0;a=[].concat(Object(la.a)(n.map((function(e,t){return Object(x.a)({id:i+t},e)}))),Object(la.a)(b)),y([{rowId:i,columnName:t[0].name}])}if(r&&(a=b.map((function(e){return r[e.id]?Object(x.a)(Object(x.a)({},e),r[e.id]):e}))),c){var o=new Set(c);a=b.filter((function(e){return!o.has(e.id)}))}f(a)};return Object(n.jsxs)(Vt.a,{open:s,onClose:o,children:[Object(n.jsx)(Gt.a,{children:Object(n.jsx)(p.a,{minHeight:500,children:Object(n.jsxs)(tt.a,{rows:b,columns:t,getRowId:da,children:[Object(n.jsx)(at.d,{onCommitChanges:D,editingCells:v,onEditingCellsChange:y,addedRows:[],onAddedRowsChange:function(){return D({added:[{}]})}}),Object(n.jsx)(tt.b,{cellComponent:ua,columnExtensions:i}),Object(n.jsx)(tt.d,{}),Object(n.jsx)(tt.e,{selectTextOnEditStart:!0}),Object(n.jsx)(tt.c,{showAddCommand:!0,showDeleteCommand:!0})]})})}),Object(n.jsxs)(zt.a,{children:[Object(n.jsx)(O.a,{color:"primary",onClick:N,disabled:k,children:"Submit"}),Object(n.jsx)(O.a,{color:"default",onClick:o,disabled:k,children:"Cancel"})]})]})},ba=[{name:"distance",title:"Distance (km)"},{name:"price",title:"Price (#)"}],ha=[{columnName:"distance",align:"left"},{columnName:"price",width:120,align:"right"}],pa=function(){var e=Object(r.useContext)(It).modes,t=Object(r.useContext)(sa).switchModes,a=c.a.useState([]),i=Object(h.a)(a,2),o=i[0],s=i[1],l=c.a.useState([]),d=Object(h.a)(l,2),u=d[0],j=d[1],b=c.a.useState([]),O=Object(h.a)(b,2),x=O[0],m=O[1],g=function(){var e=Object(U.a)(W.a.mark((function e(){var t,a,n,r,c;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.a.get("/api/admin/price_matrix");case 3:t=e.sent,a=t.data,n=a.motorcycle,r=a.car,c=a.minivan,console.log("data",n,r,c),n&&s(n.priceList),r&&j(r.priceList),c&&m(c.priceList),console.log(t.data),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();c.a.useEffect((function(){return Object(U.a)(W.a.mark((function e(){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",g());case 1:case"end":return e.stop()}}),e)})))()}),[]);var v=function(e){var t=e.mode,a=c.a.useState(!1),r=Object(h.a)(a,2),i=r[0],l=r[1],d=function(){switch(t){case"Motorcycle":return o;case"Car":return u;case"Mini Van":return x;default:return[]}}(),b=function(){switch(t){case"Motorcycle":return s;case"Car":return j;case"Mini Van":return m;default:return function(){console.log("no mode")}}}(),O=c.a.useState([]),f=Object(h.a)(O,2),g=f[0],v=f[1];return Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsx)(nt,{rows:d,columns:ba,columnExtensions:ha,footer:Object(n.jsx)(p.a,{width:1,p:1,display:"flex",justifyContent:"flex-end",children:Object(n.jsx)(F.a,{onClick:function(){v(d),l(!0)},children:Object(n.jsx)(ca.a,{})})})}),Object(n.jsx)(ja,{rowsStart:g,columnExtensions:ha,columns:ba,open:i,onClose:function(){return l(!1)},mode:t,setMatrix:b})]})};return Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsx)(p.a,{display:"flex",flexDirection:"row",mb:3,children:Object(n.jsx)(f.a,{variant:"h5",color:"initial",gutterBottom:!0,children:"Pricing Matrix"})}),Object(n.jsxs)(J.a,{container:!0,spacing:5,children:[Object(n.jsxs)(J.a,{item:!0,xs:12,md:4,children:[Object(n.jsx)(ia.a,{control:Object(n.jsx)(oa.a,{checked:e.includes("Motorcycle"),onClick:function(){return t("Motorcycle")}}),label:"Motorcycle",labelPlacement:"start"}),Object(n.jsx)(v,{mode:"Motorcycle"})]}),Object(n.jsxs)(J.a,{item:!0,xs:12,md:4,children:[Object(n.jsx)(ia.a,{control:Object(n.jsx)(oa.a,{checked:e.includes("Car"),onClick:function(){return t("Car")}}),label:"Car",labelPlacement:"start"}),Object(n.jsx)(v,{mode:"Car"})]}),Object(n.jsxs)(J.a,{item:!0,xs:12,md:4,children:[Object(n.jsx)(ia.a,{control:Object(n.jsx)(oa.a,{checked:e.includes("Mini Van"),onClick:function(){return t("Mini Van")}}),label:"Minivan",labelPlacement:"start"}),Object(n.jsx)(v,{mode:"Mini Van"})]})]})]})},Oa=a(275),fa=a(445),xa=a(110),ma=a.n(xa),ga=a(272),va=a.n(ga),ya=a(145),wa=a.n(ya),Ca=wa()("http://192.168.0.118:3005");Ca.on("connect",(function(){console.log("I connected...",(new Date).toLocaleTimeString())})),Ca.on("disconnect",(function(){console.log("I disconnected...",(new Date).toLocaleTimeString())})),Ca.on("drivers",(function(e){console.log("drivers available are...",e,(new Date).toLocaleTimeString())}));for(var ka="DRIVERS_LOCATION",Sa="SET_ALERT",Ea="REMOVE_ALERT",Na="GET_ALL_NOTIFICATIONS",Da="NOTIFICATION_ERROR",Ia="CLEAR_NEW_NOTIFICATIONS",Aa="READ_NOTIFICATION",Ta="READ_ALL_NOTIFICATIONS",Ra="LOADING_USER",Pa="LOGIN_SUCCESS",_a="LOGIN_FAIL",La="AUTH_ERROR",Fa="USER_LOADED",Ma="LOGOUT",Ba="CLEAR_ERROR",Wa="SET_MODES",Ua="NEW_ORDER",Va="CLEAR_NEW_ORDER",Ga="SET_PATH",za="CLEAR_PATH",Ha="REGISTER_SUCCESS",Qa="REGISTER_FAIL",Ja=function(e,t){switch(t.type){case ka:return Object(x.a)(Object(x.a)({},e),t.payload);case Wa:return Object(x.a)(Object(x.a)({},e),{},{modes:t.payload});default:return e}},Za=function(e){var t=Object(r.useReducer)(Ja,{drivers:{},markers:[],modes:[]}),a=Object(h.a)(t,2),c=a[0],i=a[1];return Object(n.jsx)(It.Provider,{value:{drivers:c.drivers,markers:c.markers,modes:c.modes,setDrivers:function(e){var t=Object.keys(e).map((function(t){return Object(x.a)(Object(x.a)({},e[t]),{},{_id:t})}));i({type:ka,payload:{markers:t,drivers:e}})},setModes:function(e){console.log("modes gotten...",e),i({type:Wa,payload:e})}},children:e.children})},Ka=[],qa=0;qa<100;qa++)Ka.push({id:qa,name:"Samuel Seibidor",phone:"09022003627",email:"samrythmn@gmail.com"});var $a=[{name:"name",title:"Name"},{name:"phone",title:"Phone"},{name:"email",title:"Email"}],Ya=[{columnName:"name"},{columnName:"phone"},{columnName:"email"}],Xa=function(e){c.a.useEffect((function(){I()}),[]);var t=c.a.useState([]),a=Object(h.a)(t,2),r=a[0],i=a[1],o=c.a.useState([]),s=Object(h.a)(o,2),l=s[0],d=s[1],u=c.a.useState([]),j=Object(h.a)(u,2),b=j[0],O=j[1],x=c.a.useState([]),m=Object(h.a)(x,2),g=m[0],v=m[1],y=c.a.useState(0),w=Object(h.a)(y,2),C=w[0],k=w[1],S=c.a.useState(!1),E=Object(h.a)(S,2),N=E[0],D=E[1],I=function(){var e=Object(U.a)(W.a.mark((function e(){var t,a;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(!0),e.prev=1,e.next=4,ae.a.get("/api/admin/users");case 4:t=e.sent,a=t.data,i(a.filter((function(e){return!e.valid&&!e.banned}))),d(a.filter((function(e){return e.valid&&!e.banned}))),O(a.filter((function(e){return e.banned}))),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:D(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return c.a.useEffect((function(){switch(C){case 0:v(l);break;case 1:v(r);break;case 2:v(b)}}),[C,N,r,l,b]),Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsx)(p.a,{display:"flex",flexDirection:"row",mb:3,children:Object(n.jsx)(f.a,{variant:"h5",color:"initial",gutterBottom:!0,children:"Users"})}),Object(n.jsx)(et,{aria:"deliveries tab",tabs:["Active","Pending","Blacklist"],onChange:function(e){return k(e)}}),Object(n.jsx)(nt,{rows:g,columns:$a,getRowId:function(e){return e._id},columnExtensions:Ya,loading:N,onClick:function(t){e.history.push("/dashboard/driver/".concat(t))}})]})},en=a(276);function tn(e,t){switch(t.type){case Sa:return t.payload;case Ea:return{msg:"",type:""};default:return e}}var an=function(e){var t=Object(r.useReducer)(tn,{msg:"",type:""}),a=Object(h.a)(t,2),c=a[0],i=a[1],o=function(){i({type:Ea})};return Object(n.jsx)(P.Provider,{value:{alert:c,setAlert:function(e,t){i({type:Sa,payload:{msg:e,type:t}}),setTimeout((function(){o()}),500)}},children:e.children})},nn=function(e){var t=Object(r.useContext)(P).alert,a=Object(r.createRef)();return Object(r.useEffect)((function(){""!==t.msg&&""!==t.type&&a.current.enqueueSnackbar(t.msg,{variant:t.type,preventDuplicate:!0})}),[t,a]),Object(n.jsx)(en.a,{ref:a,maxSnack:4,children:e.children})},rn=function(e){return Object(n.jsx)(an,{children:Object(n.jsx)(nn,{children:e.children})})},cn=function(e,t){switch(t.type){case Na:return Object(x.a)(Object(x.a)({},e),{},{notifications:t.payload});case"NEW_NOTIFICATIONS":return Object(x.a)(Object(x.a)({},e),{},{newNotifications:!0});case Ta:case Aa:return Object(x.a)(Object(x.a)({},e),t.payload);case Ia:return Object(x.a)(Object(x.a)({},e),{},{newNotifications:!1});case Ua:return Object(x.a)(Object(x.a)({},e),{},{newOrder:!0});case Va:return Object(x.a)(Object(x.a)({},e),{},{newOrder:!1});case"ADS":return Object(x.a)(Object(x.a)({},e),{},{ads:t.payload.ads});default:return e}},on=function(e){var t=Object(r.useReducer)(cn,{notifications:[],newNotifications:!1,currentNotification:null,ads:[],newOrder:!0}),a=Object(h.a)(t,2),c=a[0],i=a[1],o=function(){var e=Object(U.a)(W.a.mark((function e(){var t;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.a.get("api/users/ads");case 3:t=e.sent,i({type:"ADS",payload:t.data}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(U.a)(W.a.mark((function e(){var t;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.a.get("/api/notifications");case 3:t=e.sent,i({type:Na,payload:t.data}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),i({type:Da,payload:e.t0.response&&(e.t0.response.data&&e.t0.response.data.msg||e.t0.response.statusText)||"Runtime Error"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(U.a)(W.a.mark((function e(t){var a;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.a.post("/api/notifications/read/".concat(t));case 3:a=e.sent,i({type:Aa,payload:a.data}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(U.a)(W.a.mark((function e(){var t;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.a.post("/api/notifications/read_all");case 3:t=e.sent,i({type:Ta,payload:t.data}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),i({type:Da,payload:e.t0.response&&(e.t0.response.data&&e.t0.response.data.msg||e.t0.response.statusText)||"Runtime Error"});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(n.jsx)(rt.Provider,{value:{notifications:c.notifications,currentNotification:c.currentNotification,newNotifications:c.newNotifications,ads:c.ads,newOrder:c.newOrder,readNotification:l,readAllNotifications:d,getNotifications:s,clearNewNotifications:function(){i({type:Ia})},getAds:o,setNewOrder:function(){return i({type:Ua})},clearNewOrder:function(){return i({type:Va})}},children:e.children})},sn=function(e,t){switch(t.type){case Ra:return Object(x.a)(Object(x.a)({},e),{},{loading:!0,isAuthenticated:!1});case Fa:return Object(x.a)(Object(x.a)(Object(x.a)({},e),t.payload),{},{isAuthenticated:!0,loading:!1,userRole:t.payload.user&&t.payload.user.role});case Ha:case Pa:return localStorage.setItem("token",t.payload.token),Object(x.a)(Object(x.a)(Object(x.a)({},e),t.payload),{},{isAuthenticated:!0,loading:!1});case Qa:case _a:case La:return localStorage.removeItem("token"),Object(x.a)(Object(x.a)({},e),{},{token:null,isAuthenticated:!1,loading:!1,userRole:null,error:t.payload});case Ma:return localStorage.removeItem("token"),Object(x.a)(Object(x.a)({},e),{},{token:null,isAuthenticated:!1,loading:!1,userRole:null,error:null,user:null});case Ba:return Object(x.a)(Object(x.a)({},e),{},{error:null});case Ga:return Object(x.a)(Object(x.a)({},e),{},{path:t.payload});case za:return Object(x.a)(Object(x.a)({},e),{},{path:null});default:return e}},ln=function(e){e?ae.a.defaults.headers.common["x-auth-token"]=e:delete ae.a.defaults.headers.common["x-auth-token"]},dn=function(e){var t={token:localStorage.getItem("token"),isAuthenticated:!1,loading:!1,userRole:null,error:null,user:null,notifications:null,details:null,path:null},a=Object(r.useReducer)(sn,t),c=Object(h.a)(a,2),i=c[0],o=c[1],s={headers:{"Content-Type":"application/json"}},l=function(){var e=Object(U.a)(W.a.mark((function e(){var t;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!localStorage.token){e.next=5;break}ln(localStorage.token),b(),e.next=6;break;case 5:return e.abrupt("return");case 6:return e.prev=6,e.next=9,ae.a.get("/api/auth");case 9:t=e.sent,console.log("res data...",t.data),o({type:Fa,payload:t.data}),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(6),o({type:La,payload:e.t0.response&&(e.t0.response.data&&e.t0.response.data.msg||e.t0.response.statusText)||"Runtime Error"}),setTimeout((function(){j()}),500);case 18:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(U.a)(W.a.mark((function e(t){var a;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(),e.prev=1,e.next=4,ae.a.post("/api/admin",t,s);case 4:a=e.sent,console.log(a.data.role),o({type:Ha,payload:a.data}),l(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),o({type:Qa,payload:e.t0.response&&(e.t0.response.data&&e.t0.response.data.msg||e.t0.response.statusText)||"Runtime Error"}),setTimeout((function(){j()}),500);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(U.a)(W.a.mark((function e(t){var a;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(),e.prev=1,e.next=4,ae.a.post("/api/auth",t,s);case 4:if("admin"===(a=e.sent).data.role){e.next=7;break}throw Error("Not an admin account");case 7:console.log(a.data.role),o({type:Pa,payload:a.data}),l(),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0),o({type:_a,payload:e.t0.response&&(e.t0.response.data&&e.t0.response.data.msg||e.t0.response.statusText)||"Runtime Error"}),setTimeout((function(){j()}),500);case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),j=function(){o({type:Ba})},b=function(){o({type:Ra})},p=function(){o({type:za})};return Object(n.jsx)(_.Provider,{value:{token:i.token,isAuthenticated:i.isAuthenticated,loading:i.loading,userRole:i.userRole,error:i.error,user:i.user,path:i.path,details:i.details,notifications:i.notifications,loadUser:l,register:d,login:u,logout:function(){o({type:Ma})},clearErrors:j,getPath:function(){var e=i.path;return p(),e},setPath:function(e){o({type:Ga,payload:e})},clearPath:p},children:e.children})},un=function(e,t){switch(t.type){case"CREATE_SOCKET":return Object(x.a)(Object(x.a)({},e),{},{socket:t.payload});default:return e}},jn=function(e){var t=Object(r.useContext)(rt),a=t.getAds,c=t.getNotifications,i=t.setNewOrder,o=Object(r.useContext)(_).isAuthenticated,s=Object(r.useContext)(It),l=s.setDrivers,d=s.setModes,u=s.modes,j=Object(r.useReducer)(un,{socket:null}),b=Object(h.a)(j,2),p=b[0],O=b[1];Object(r.useEffect)((function(){var e=wa()("localhost:3005/");e.on("drivers",(function(e){l(e),console.log("drivers gotten",e)})),e.on("modes",d),e.emit("getDrivers"),O({type:"CREATE_SOCKET",payload:e}),e.on("NewDelivery",i)}),[]);return Object(r.useEffect)((function(){if(p.socket){try{ae.a.post("/api/notifications/socket",{id:p.socket.id})}catch(e){console.log(e)}p.socket.on("connect",Object(U.a)(W.a.mark((function e(){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("I connected...",p.socket.id,(new Date).toLocaleTimeString());case 1:case"end":return e.stop()}}),e)})))),p.socket.on("NewNotification",(function(){console.log("new notifications..."),c()})),p.socket.on("Ads",a),p.socket.on("trial",(function(){return console.log("Try")}))}}),[p.socket,o]),Object(n.jsx)(sa.Provider,{value:{socket:p.socket,switchModes:function(e){var t,a=(u.includes(e)?u.filter((function(t){return t!==e})):[].concat(Object(la.a)(u),[e])).sort((function(e,t){var a=["Motorcycle","Car","Mini Van"];return a.indexOf(e)-a.indexOf(t)}));null===(t=p.socket)||void 0===t||t.emit("switchModes",a)}},children:e.children})},bn=function(e){return Object(n.jsx)(dn,{children:Object(n.jsx)(Za,{children:Object(n.jsx)(on,{children:Object(n.jsx)(jn,{children:e.children})})})})},hn=a(385),pn=function(e){var t=e.component,a=Object(jt.a)(e,["component"]),c=Object(r.useContext)(_),i=c.isAuthenticated,o=c.loadUser,s=c.loading,l=Object(r.useState)(!0),d=Object(h.a)(l,2),j=d[0],b=d[1];Object(r.useEffect)((function(){i||Object(U.a)(W.a.mark((function e(){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:b(!1);case 3:case"end":return e.stop()}}),e)})))()}),[]);var O=function(e){return!j&&!s||i?i||s?Object(n.jsx)(t,Object(x.a)({},e)):Object(n.jsx)(u.a,{to:"/login"}):Object(n.jsxs)(p.a,{alignItems:"center",justifyContent:"center",display:"flex",height:"100%",children:[Object(n.jsx)(Bt.a,{}),Object(n.jsx)(f.a,{variant:"subtitle1",color:"initial",children:"Loading..."})]})};return Object(n.jsx)(u.b,Object(x.a)(Object(x.a)({},a),{},{render:function(e){return Object(n.jsx)(O,Object(x.a)({},e))}}))},On=a(444),fn=a(268),xn=a(269),mn=a.n(xn),gn=a(270),vn=a.n(gn),yn=a(271),wn=a.n(yn),Cn={title:"",link:"",image:null,expires:null},kn=function(){var e=Object(r.useState)([]),t=Object(h.a)(e,2),a=t[0],i=t[1],o=Object(r.useState)(Cn),s=Object(h.a)(o,2),l=s[0],d=s[1],u=Object(r.useState)(!1),j=Object(h.a)(u,2),b=j[0],g=j[1],v=Object(r.useState)(!1),y=Object(h.a)(v,2),w=y[0],C=y[1],k=function(){g(!1),d(Cn)},S=function(){var e=Object(U.a)(W.a.mark((function e(){var t;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.a.get("/api/admin/ads");case 3:t=e.sent,i(t.data.map((function(e){return Object(x.a)({id:e._id},e)}))),console.log(t.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(U.a)(W.a.mark((function e(t){var n;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.a.post("/api/admin/ads/valid/".concat(t));case 3:n=e.sent,i(a.map((function(e){return e._id!==t?e:Object(x.a)(Object(x.a)({},e),{},{valid:n.data.valid})}))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(U.a)(W.a.mark((function e(t){var a,n,r,c,i,o,s;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C(!0),a=l.title,n=l.link,r=l.image,c=l.expires,a){e.next=6;break}alert("Please input a title"),e.next=26;break;case 6:if(r){e.next=10;break}alert("Please attach an image file"),e.next=26;break;case 10:return e.prev=10,i=new FormData,o="samtwopointoh",i.append("file",r),i.append("upload_preset","jwidlccj"),i.append("cloud_name",o),i.append("folder","ampalAds"),s="https://api.cloudinary.com/v1_1/".concat(o,"/auto/upload"),e.next=20,fetch(s,{method:"POST",body:i}).then((function(e){return e.json()})).then(function(){var e=Object(U.a)(W.a.mark((function e(t){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae.a.post("/api/admin/ads",{title:a,link:n,image:t.secure_url,expires:c});case 2:S(),k();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(10),console.log(e.t0),alert("An error occured while uploading this ad");case 26:C(!1);case 27:case"end":return e.stop()}}),e,null,[[10,22]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){S()}),[]),Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsxs)(p.a,{display:"flex",flexDirection:"row",mb:3,children:[Object(n.jsx)(f.a,{variant:"h5",color:"initial",gutterBottom:!0,children:"Advertisement"}),Object(n.jsx)(p.a,{ml:5,children:Object(n.jsx)(O.a,{variant:"outlined",color:"default",onClick:function(){return g(!0)},children:"Create"})})]}),Object(n.jsxs)(p.a,{children:[Object(n.jsx)(Z.a,{children:Object(n.jsx)(p.a,{height:700,width:1,children:Object(n.jsx)(fn.a,{columns:[{field:"image",headerName:"Image",width:300,renderCell:function(e){return Object(n.jsx)("a",{href:e.value,rel:"noreferrer",target:"_blank",children:Object(n.jsx)("img",{width:250,height:250,src:e.value,alt:e.rowIndex})})}},{field:"title",headerName:"Title",width:300},{field:"link",headerName:"Link",width:700,renderCell:function(e){return Object(n.jsx)(On.a,{href:e.value,target:"_blank",children:e.value})}},{field:"dateUploaded",headerName:"Created",width:150,valueFormatter:function(e){return new Date(e.value).toLocaleDateString()}},{field:"expires",headerName:"Expires",width:150,valueFormatter:function(e){return e.value?new Date(e.value).toLocaleDateString():""}},{field:"valid",headerName:"Valid",width:150,renderCell:function(e){return Object(n.jsx)(F.a,{color:e.value?"primary":"default",onClick:function(){return E(e.row.id)},children:e.value?Object(n.jsx)(mn.a,{}):Object(n.jsx)(vn.a,{})})}}],rows:a,rowHeight:100})})}),Object(n.jsxs)(Vt.a,{open:b,onClose:!w&&k,"aria-labelledby":"",children:[Object(n.jsx)(Ht.a,{children:"Add Advert"}),Object(n.jsx)(Gt.a,{children:Object(n.jsx)(p.a,{width:500,children:Object(n.jsxs)(J.a,{container:!0,spacing:3,display:"flex",direction:"column",children:[Object(n.jsx)(J.a,{item:!0,children:Object(n.jsx)(m.a,{label:"Title",variant:"standard",value:l.title,onChange:function(e){return d(Object(x.a)(Object(x.a)({},l),{},{title:e.currentTarget.value}))},fullWidth:!0})}),Object(n.jsx)(J.a,{item:!0,children:Object(n.jsx)(m.a,{label:"Link",variant:"standard",value:l.link,onChange:function(e){return d(Object(x.a)(Object(x.a)({},l),{},{link:e.currentTarget.value}))},fullWidth:!0})}),Object(n.jsx)(J.a,{item:!0,children:Object(n.jsx)(p.a,{flex:!0,flexDirection:"row",children:Object(n.jsx)(m.a,{label:"File",variant:"standard",disabled:!0,value:l.image?l.image.name:"",onChange:function(e){},fullWidth:!0,InputProps:{endAdornment:Object(n.jsxs)(L.a,{position:"end",children:[Object(n.jsx)("input",{id:"file-input",type:"file",accept:"image/*",style:{display:"none"},onChange:function(e){d(Object(x.a)(Object(x.a)({},l),{},{image:e.target.files[0]}))}}),Object(n.jsx)("label",{htmlFor:"file-input",children:Object(n.jsx)(F.a,{component:"span",color:"primary",children:Object(n.jsx)(wn.a,{})})})]})}})})}),Object(n.jsx)(J.a,{item:!0,children:Object(n.jsx)(V.a,{variant:"dialog",inputVariant:"standard",label:"Expires",value:l.expires,minDate:new Date,onChange:function(e){return d(Object(x.a)(Object(x.a)({},l),{},{expires:e}))},fullWidth:!0,views:["month","date","year"],format:"yyyy/MM/dd"})})]})})}),Object(n.jsxs)(zt.a,{children:[Object(n.jsx)(O.a,{onClick:N,disabled:w,color:"primary",children:"Add"}),Object(n.jsx)(O.a,{onClick:k,disabled:w,color:"default",children:"Cancel"})]})]})]})]})},Sn=Object(Oa.a)({palette:{primary:{main:ma.a[800]},secondary:{main:va.a.A400},action:{focus:ma.a[500],selected:ma.a[700],hover:ma.a[100]}}});var En=function(e){var t=Object(u.g)(),a=Object(r.useContext)(rt),c=a.newOrder,i=a.clearNewOrder;return Object(n.jsx)(hn.a,{direction:"left",in:c,mountOnEnter:!0,unmountOnExit:!0,children:Object(n.jsx)(p.a,{position:"absolute",bottom:50,right:100,zIndex:"modal",onClick:function(){return t.push("/dashboard/deliveries")},children:Object(n.jsx)(Z.a,{elevation:4,children:Object(n.jsxs)(p.a,{p:2,width:320,alignItems:"center",justifyContent:"space-between",display:"flex",bgcolor:"secondary.main",color:"secondary.contrastText",children:[Object(n.jsx)("img",{src:"https://www.flaticon.com/svg/static/icons/svg/891/891012.svg",height:50,width:50,alt:"Alarm bell"}),Object(n.jsx)(f.a,{variant:"h6",color:"inherit",children:"New order notice"}),Object(n.jsx)(F.a,{onClick:function(e){e.stopPropagation(),i()},children:Object(n.jsx)(b.a,{})})]})})})})},Nn=function(){return Object(n.jsx)(Za,{children:Object(n.jsx)(fa.a,{theme:Sn,children:Object(n.jsx)(rn,{children:Object(n.jsx)(bn,{children:Object(n.jsx)(s.a,{utils:l.a,children:Object(n.jsx)(d.a,{children:Object(n.jsxs)(u.d,{children:[Object(n.jsx)(u.b,{exact:!0,path:"/login",component:M}),Object(n.jsx)(u.b,{exact:!0,path:"/register",component:G}),Object(n.jsx)(u.b,{exact:!0,path:"/forgot",component:H}),Object(n.jsx)(u.b,{path:"/dashboard",children:Object(n.jsxs)(Je,{children:[Object(n.jsx)(pn,{exact:!0,path:"/dashboard/deliveries",component:ut}),Object(n.jsx)(pn,{exact:!0,path:"/dashboard/drivers",component:Yt}),Object(n.jsx)(pn,{exact:!0,path:"/dashboard/users",component:Xa}),Object(n.jsx)(u.b,{exact:!0,path:"/dashboard/analytics",component:re}),Object(n.jsx)(pn,{exact:!0,path:"/dashboard/pricing",component:pa}),Object(n.jsx)(pn,{exact:!0,path:"/dashboard/delivery/:id",component:Jt}),Object(n.jsx)(pn,{exact:!0,path:"/dashboard/driver/:id",component:na}),Object(n.jsx)(pn,{exact:!0,path:"/dashboard/ads",component:kn}),Object(n.jsx)(En,{})]})}),Object(n.jsx)(u.a,{from:"/",to:"/login"})]})})})})})})})},Dn=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,455)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;a(e),n(e),r(e),c(e),i(e)}))};o.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(Nn,{})}),document.getElementById("root")),Dn()}},[[380,1,2]]]);
//# sourceMappingURL=main.fa8c5ada.chunk.js.map